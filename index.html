<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psy Documentation Generator</title>
    <style>
        /* General Styles from Adult DC Summary */
        body {
            font-family: sans-serif, Arial; /* Added Arial as fallback from LD */
            line-height: 1.6;
            margin: 0;
            padding: 10px;
            background-color: #f4f4f4;
            color: #333;
            font-size: 16px; /* From LD */
        }
        .container { /* This class is used by both, ensure styles are compatible or make unique */
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 900px; /* From Adult DC */
            margin: 10px auto; /* Adjusted margin from LD */
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 1.8em;
            margin-top: 15px; /* From LD */
            margin-bottom: 25px; /* From LD */
        }
        .navigation-area {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .navigation-area .nav-row {
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        .navigation-area .nav-label {
            margin-right: 10px;
            font-weight: bold;
            font-size: 1.1em;
            color: #555;
        }
        .navigation-area button {
            padding: 10px 15px;
            margin: 5px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
        }
        .navigation-area button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .navigation-area button.active { /* This style will make the active button darker blue */
            background-color: #2980b9; 
        }

        /* Form Section Display */
        .form-section {
            display: none; /* Hidden by default */
        }
        .form-section.active {
            display: block; /* Shown when active */
        }

        /* Styles from Adult DC Summary Form */
        #adultDcSummaryContainer fieldset {
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 20px;
            padding: 15px;
        }
        #adultDcSummaryContainer legend {
            font-weight: bold;
            color: #2980b9;
            padding: 0 10px;
            font-size: 1.2em;
        }
        #adultDcSummaryContainer .form-group {
            margin-bottom: 15px;
        }
        #adultDcSummaryContainer .form-group label, 
        #adultDcSummaryContainer .form-group > span,
        #adultDcSummaryContainer .form-group > .standalone-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        #adultDcSummaryContainer .form-group input[type="text"],
        #adultDcSummaryContainer .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        #adultDcSummaryContainer .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        #adultDcSummaryContainer .form-group .checkbox-group,
        #adultDcSummaryContainer .form-group .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 5px 15px;
        }
        #adultDcSummaryContainer .form-group .checkbox-group label,
        #adultDcSummaryContainer .form-group .radio-group label {
            font-weight: normal;
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        #adultDcSummaryContainer .form-group .checkbox-group label input,
        #adultDcSummaryContainer .form-group .radio-group label input {
            margin-right: 5px;
            flex-shrink: 0;
         }
        #adultDcSummaryContainer #thoughtOtherText {
            margin-top: 5px;
            min-height: 60px;
        }
        #adultDcSummaryContainer .action-buttons {
            text-align: center;
            margin-top: 20px;
        }
        #adultDcSummaryContainer .action-buttons button {
            padding: 12px 20px;
            margin-top: 10px;
            margin-right: 10px;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
        }
        #adultDcSummaryContainer .action-buttons button#generateReportBtn { background-color: #2ecc71; }
        #adultDcSummaryContainer .action-buttons button#copyReportBtn { background-color: #f39c12; }
        #adultDcSummaryContainer .action-buttons button#resetFormBtn { background-color: #e74c3c; } 
        #adultDcSummaryContainer #generatedReport {
            width: 100%;
            min-height: 300px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 0.9em;
        }
        #adultDcSummaryContainer .inline-input {
            width: auto;
            min-width: 60px;
            margin-left: 5px;
            padding: 5px 8px;
        }
        #adultDcSummaryContainer .small-input {
            width: 80px !important;
            flex-grow: 0;
        }
        #adultDcSummaryContainer .referral-date-input {
            margin-left: 5px;
            margin-top: 5px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            width: 150px;
        }
        #adultDcSummaryContainer .form-group .referral-date-label {
            display: inline-block;
            margin-right: 5px;
            margin-top: 8px;
            font-weight: normal;
        }
        #adultDcSummaryContainer .work-item-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        #adultDcSummaryContainer .work-v-item {
            border: 1px solid #e0e0e0;
            padding: 10px;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        #adultDcSummaryContainer .work-v-item .work-v-label-container {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        #adultDcSummaryContainer .work-v-item .work-v-label-container input[type="checkbox"] {
            margin-right: 8px;
        }
        #adultDcSummaryContainer .work-v-item .work-v-label-container span {
            font-weight: bold;
        }
        #adultDcSummaryContainer .work-v-item .work-v-rating {
            padding-left: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px 10px;
        }
        #adultDcSummaryContainer .work-v-item .work-v-rating label {
            font-weight: normal;
        }
        #adultDcSummaryContainer .work-overall-nil-group {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }

        /* Styles from LD Assessment Form */
        #ldAssessmentContainer h2, #ldAssessmentContainer h3, #ldAssessmentContainer h4, #ldAssessmentContainer h5 { color: #333; margin-top: 20px; }
        #ldAssessmentContainer h4 { font-size: 1.2em; margin-bottom: 10px;}
        #ldAssessmentContainer h5 { margin-top: 15px; margin-bottom: 8px; font-size: 1.05em; }
        #ldAssessmentContainer fieldset { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        #ldAssessmentContainer legend { font-weight: bold; color: #555; padding: 0 10px; font-size: 1.1em; }
        #ldAssessmentContainer label { display: block; margin-bottom: 5px; font-weight: 500;} 
        #ldAssessmentContainer input[type="text"], 
        #ldAssessmentContainer input[type="number"], 
        #ldAssessmentContainer input[type="date"], 
        #ldAssessmentContainer textarea, 
        #ldAssessmentContainer select {
            width: 100%; 
            padding: 10px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1em;
        }
        #ldAssessmentContainer textarea { min-height: 80px; }
        #ldAssessmentContainer .checkbox-group label, 
        #ldAssessmentContainer .radio-group label { display: inline-block; margin-right: 15px; margin-bottom: 8px; font-weight: normal;}
        #ldAssessmentContainer .checkbox-group input[type="checkbox"], 
        #ldAssessmentContainer .radio-group input[type="radio"] { margin-right: 5px; vertical-align: middle; }
        #ldAssessmentContainer .inline-fields label { display: inline-block; margin-right: 5px; }
        #ldAssessmentContainer .inline-fields input[type="text"], 
        #ldAssessmentContainer .inline-fields input[type="number"], 
        #ldAssessmentContainer .inline-fields select { width: auto; display: inline-block; margin-right:10px; }
        #ldAssessmentContainer .section-exclude { float: right; font-size: 0.9em; }
        #ldAssessmentContainer .sub-section-exclude { margin-left: 10px; font-size: 0.9em; font-weight: normal; color: #666;}
        #ldAssessmentContainer .report-output { margin-top: 30px; }
        #ldAssessmentContainer .report-output textarea { width: 100%; height: 500px; font-family: monospace; font-size: 0.9em; }
        #ldAssessmentContainer button#generateLDReportBtn { 
            background-color: #007bff; color: white; padding: 12px 18px;
            border: none; border-radius: 4px; cursor: pointer; font-size: 1.1em; display: block; width: 100%; margin-top: 20px;
        }
        #ldAssessmentContainer button#generateLDReportBtn:hover { background-color: #0056b3; }
        #ldAssessmentContainer button#copyLDReportBtn { 
            background-color: #28a745; color: white; padding: 10px 15px;
            border: none; border-radius: 4px; cursor: pointer; font-size: 1em; margin-top: 10px;
        }
        #ldAssessmentContainer button#copyLDReportBtn:hover { background-color: #218838; }
        #ldAssessmentContainer #ldCopyMessage { margin-left: 10px; color: green; font-style: italic; display: none; } /* Unique ID */
        #ldAssessmentContainer .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        #ldAssessmentContainer .grid-item { }
        #ldAssessmentContainer .sub-section { margin-left: 10px; border-left: 2px solid #eee; padding-left: 10px; }
        #ldAssessmentContainer .form-row { display: flex; flex-wrap: wrap; gap: 15px; align-items: flex-start; margin-bottom:15px;}
        #ldAssessmentContainer .form-row > div { flex: 1; min-width: 250px;} 
        #ldAssessmentContainer .form-row label { margin-bottom: 3px; }
        #ldAssessmentContainer .fine-motor-grid { 
            display: grid; 
            grid-template-columns: auto repeat(4, 1fr); 
            gap: 5px 10px; 
            align-items: center;
            margin-bottom: 10px;
        }
        #ldAssessmentContainer .fine-motor-grid label { margin-bottom: 0; font-weight: normal; }
        #ldAssessmentContainer .fine-motor-grid > span { font-weight: bold; }
        #ldAssessmentContainer .fm-header { text-align: center;}
        #ldAssessmentContainer .mas-function-group { border: 1px solid #eee; padding: 10px; margin-bottom: 10px; border-radius: 4px; }
        #ldAssessmentContainer .mas-function-group div { margin-bottom: 8px; display: flex; flex-wrap: wrap; align-items: center;}
        #ldAssessmentContainer .mas-function-group div label { display: inline-block; width: 130px; font-weight: normal; margin-bottom:0; }
        #ldAssessmentContainer .mas-function-group div input { width: 120px; display: inline-block; padding: 6px; font-size: 0.95em; margin-bottom: 0; }
        #ldAssessmentContainer table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        #ldAssessmentContainer th, #ldAssessmentContainer td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 0.95em;}
        #ldAssessmentContainer th { background-color: #f2f2f2; }
        #ldAssessmentContainer .limb-range-section .form-row { 
            display: flex; flex-wrap: nowrap; font-weight: bold;
            background-color: #f9f9f9; border-bottom: 1px solid #ddd;
        }
        #ldAssessmentContainer .limb-range-section .form-row > div { flex: 1; padding: 8px; text-align: center; }
        #ldAssessmentContainer .limb-range-section .form-row > div:first-child { text-align: left; flex-basis: 100px; flex-grow: 0;}
        #ldAssessmentContainer .limb-data-row { display: flex; flex-wrap: wrap; align-items: center; border-bottom: 1px solid #eee; padding: 10px 0; }
        #ldAssessmentContainer .limb-data-row > div { padding: 5px; box-sizing: border-box; }
        #ldAssessmentContainer .limb-name { flex-basis: 100px; flex-grow: 0; font-weight: bold;}
        #ldAssessmentContainer .arom-group, #ldAssessmentContainer .prom-group, #ldAssessmentContainer .contracture-group { flex: 1; min-width: 150px; }
        #ldAssessmentContainer .functional-cb-label { font-weight: normal; display: inline-flex; align-items: center; margin-left:5px;}
        #ldAssessmentContainer .functional-cb-label input[type="checkbox"] { margin-right: 5px; width: auto;}


        /* Responsive Merges and Overrides */
        @media (max-width: 768px) {
            .container { margin: 10px; padding: 10px; } 
            h1 { font-size: 1.5em; }
            legend { font-size: 1.1em; }
            #adultDcSummaryContainer .form-group .checkbox-group,
            #adultDcSummaryContainer .form-group .radio-group,
            #adultDcSummaryContainer .work-v-item .work-v-rating {
                flex-direction: column;
                align-items: flex-start;
            }
            #adultDcSummaryContainer .form-group .checkbox-group label,
            #adultDcSummaryContainer .form-group .radio-group label,
            #adultDcSummaryContainer .work-v-item .work-v-rating label {
                 width: 100%;
             }
            #adultDcSummaryContainer .action-buttons button { width: calc(33.33% - 7px); margin: 5px 3px; }
            #adultDcSummaryContainer .form-group > input.inline-input.small-input { width: 100px !important; display: block; margin-left: 0; margin-top: 5px; }
            #adultDcSummaryContainer .radio-group label input.inline-input.small-input { width: 100px !important; margin-left: 5px; }
            #adultDcSummaryContainer .referral-date-input { width: calc(100% - 100px); min-width: 150px; }
            #adultDcSummaryContainer .form-group .referral-date-label { display: block; margin-bottom: 5px; }
            #adultDcSummaryContainer .referral-date-input { width: 100%; margin-left: 0; }

            #ldAssessmentContainer .form-row > div { min-width: 100%; } 
            #ldAssessmentContainer .fine-motor-grid { grid-template-columns: auto repeat(2, 1fr); } 
            #ldAssessmentContainer .mas-function-group div label { width: 100%; margin-bottom: 3px;}
            #ldAssessmentContainer .mas-function-group div input { width: 100%; }
            #ldAssessmentContainer .checkbox-group label, #ldAssessmentContainer .radio-group label { margin-right: 10px;}
            #ldAssessmentContainer .limb-range-section .form-row { display: none; } 
            #ldAssessmentContainer .limb-data-row { flex-direction: column; align-items: stretch; }
            #ldAssessmentContainer .limb-name { flex-basis: auto; margin-bottom: 10px; text-align: left; }
            #ldAssessmentContainer .arom-group, #ldAssessmentContainer .prom-group, #ldAssessmentContainer .contracture-group { min-width: 100%; margin-bottom: 10px;}
            #ldAssessmentContainer .arom-group input[type="text"], #ldAssessmentContainer .prom-group input[type="text"] { width: 100%;}
            #ldAssessmentContainer .functional-cb-label { display: block; margin-left:0; margin-top: 5px;}
        }

        @media (max-width: 480px) {
            body { padding: 5px; }
            h1 { font-size: 1.3em; }
            .navigation-area button { font-size: 0.9em; padding: 8px 10px; width: calc(50% - 10px); margin: 5px; }
            .navigation-area .nav-label { font-size: 1em; }
            
            #adultDcSummaryContainer .action-buttons button { width: 100%; margin: 10px 0 0 0; margin-right: 0; }
            #adultDcSummaryContainer .inline-input, 
            #adultDcSummaryContainer .small-input, 
            #adultDcSummaryContainer .referral-date-input { width: 100% !important; margin-left: 0; margin-top: 5px; display: block; }
            #adultDcSummaryContainer .form-group .radio-group label input[type="text"],
            #adultDcSummaryContainer .form-group .checkbox-group label input[type="text"] { margin-left: 0; }
            #adultDcSummaryContainer .form-group > .inline-input.small-input { margin-top: 5px; margin-left:0; }
            #adultDcSummaryContainer #thoughtOtherLabel { flex-direction: column; align-items: flex-start !important; }
            #adultDcSummaryContainer #thoughtOtherLabel input { margin-bottom: 5px; }

            #ldAssessmentContainer .fine-motor-grid { grid-template-columns: 1fr; }
            #ldAssessmentContainer .fine-motor-grid > span { grid-column: 1 / -1; text-align: left; margin-top: 10px;}
            #ldAssessmentContainer .fm-header { font-weight: normal !important; margin-left: 15px; display:block; text-align: left !important;}
            #ldAssessmentContainer .fine-motor-grid > .limb-header ~ label { margin-left: 15px;}
            #ldAssessmentContainer .inline-fields input[type="text"], 
            #ldAssessmentContainer .inline-fields input[type="number"], 
            #ldAssessmentContainer .inline-fields select { width: 100%; margin-bottom: 8px;}
            #ldAssessmentContainer .checkbox-group label, #ldAssessmentContainer .radio-group label { display: block; } 
        }
    </style>
</head>
<body>

    <div class="container"> 
        <h1>Psy Documentation Generator</h1>

        <div class="navigation-area">
            <div class="nav-row">
                <span class="nav-label">Progress:</span>
                <button id="progressLDBtn">LD</button> 
            </div>
            <div class="nav-row">
                <span class="nav-label">DC Sum:</span>
                <button id="dcAdultBtn" class="active">Adult</button>
                <button id="dcPgBtn" disabled>PG</button>
                <button id="dcCaBtn" disabled>C&A</button>
                <button id="dcLdBtn" disabled>LD</button>
            </div>
        </div>

        <div id="adultDcSummaryContainer" class="form-section active">
            <form id="adultForm">
                <!-- ... Adult DC Summary Form HTML ... -->
                <fieldset>
                    <legend>1. Mental State & Insight</legend>
                    <div class="form-group">
                        <label>Overall impression:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="overallImpression" value="Stable"> Stable</label>
                            <label><input type="radio" name="overallImpression" value="Unstable"> Unstable</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Mood:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="mood" value="Neutral"> Neutral</label>
                            <label><input type="radio" name="mood" value="Depressed"> Depressed</label>
                            <label><input type="radio" name="mood" value="Dysthymic"> Dysthymic</label>
                            <label><input type="radio" name="mood" value="Euthymic"> Euthymic</label>
                            <label><input type="radio" name="mood" value="Elated"> Elated</label>
                            <label><input type="radio" name="mood" value="Irritable"> Irritable</label>
                            <label><input type="radio" name="mood" value="Anxious"> Anxious</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Affect:</label>
                         <div class="radio-group">
                            <label><input type="radio" name="affect" value="Congruent"> Congruent</label>
                            <label><input type="radio" name="affect" value="Labile"> Labile</label>
                            <label><input type="radio" name="affect" value="Shallow"> Shallow</label>
                            <label><input type="radio" name="affect" value="Blunted"> Blunted</label>
                            <label><input type="radio" name="affect" value="Restricted"> Restricted</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Speech:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="speech" value="Relevant"> Relevant</label>
                            <label><input type="checkbox" name="speech" value="Coherent"> Coherent</label>
                            <label><input type="checkbox" name="speech" value="Spontaneous"> Spontaneous</label>
                            <label><input type="checkbox" name="speech" value="Pressured"> Pressured</label>
                            <label><input type="checkbox" name="speech" value="Slurred"> Slurred</label>
                            <label><input type="checkbox" name="speech" value="Circumstantial"> Circumstantial</label>
                            <label><input type="checkbox" name="speech" value="Tangential"> Tangential</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Hallucination:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="hallucination" value="Auditory"> Auditory</label>
                            <label><input type="checkbox" name="hallucination" value="Visual"> Visual</label>
                            <label><input type="checkbox" name="hallucination" value="Olfactory"> Olfactory</label>
                            <label><input type="checkbox" name="hallucination" value="Tactile"> Tactile</label>
                            <label><input type="checkbox" name="hallucination" value="Gustatory"> Gustatory</label>
                            <label><input type="checkbox" name="hallucination" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <span class="standalone-label">Thought (select all that apply if not Nil):</span>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="thought" value="Persecutory"> Persecutory</label>
                            <label><input type="checkbox" name="thought" value="Delusional"> Delusional</label>
                            <label><input type="checkbox" name="thought" value="Somatic"> Somatic</label>
                            <label><input type="checkbox" name="thought" value="Grandiose"> Grandiose</label>
                            <label><input type="checkbox" name="thought" value="Idea of reference"> Idea of reference</label>
                            <label><input type="checkbox" name="thought" value="Thought broadcasting"> Thought broadcasting</label>
                            <label><input type="checkbox" name="thought" value="Being control"> Being control</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label id="thoughtOtherLabel"><input type="checkbox" name="thoughtOtherChk" id="thoughtOtherChk" value="Other"> Other thoughts present:</label>
                        <textarea id="thoughtOtherText" name="thoughtOtherText" placeholder="Specify other thoughts here" style="display: none;"></textarea>
                    </div>
                    <div class="form-group">
                        <label><input type="checkbox" name="thoughtNilChk" id="thoughtNilChk" value="Nil"> Nil (for Thought)</label>
                    </div>
                    <div class="form-group">
                        <label>Behavior:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="behavior" value="Normal"> Normal</label>
                            <label><input type="checkbox" name="behavior" value="Bizarre"> Bizarre</label>
                            <label><input type="checkbox" name="behavior" value="Self-muttering"> Self-muttering</label>
                            <label><input type="checkbox" name="behavior" value="Self-giggling"> Self-giggling</label>
                            <label><input type="checkbox" name="behavior" value="Disturbing"> Disturbing</label>
                            <label><input type="checkbox" name="behavior" value="Disorganized"> Disorganized</label>
                            <label><input type="checkbox" name="behavior" value="Disinhibited"> Disinhibited</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Cognitive:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="cognitiveState" value="Oriented"> Oriented</label>
                            <label><input type="checkbox" name="cognitiveState" value="Disoriented"> Disoriented</label>
                            <label><input type="checkbox" name="cognitiveState" value="Good memory"> Good memory</label>
                            <label><input type="checkbox" name="cognitiveState" value="Poor memory"> Poor memory</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Risk:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="risk" value="Suicidal"> Suicidal</label>
                            <label><input type="checkbox" name="risk" value="Homicidal"> Homicidal</label>
                            <label><input type="checkbox" name="risk" value="Self-harm"> Self-harm</label>
                            <label><input type="checkbox" name="risk" value="Self-neglect"> Self-neglect</label>
                            <label><input type="checkbox" name="risk" value="Violent"> Violent</label>
                            <label><input type="checkbox" name="risk" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Insight:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="insight" value="Full"> Full</label>
                            <label><input type="radio" name="insight" value="Partial"> Partial</label>
                            <label><input type="radio" name="insight" value="Limited"> Limited</label>
                            <label><input type="radio" name="insight" value="Poor"> Poor</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="remarksMentalState">Remarks:</label>
                        <textarea id="remarksMentalState" name="remarksMentalState"></textarea>
                    </div>
                </fieldset>
    
                <fieldset>
                    <legend>2. Assessment Results</legend>
                    <div class="form-group work-section">
                        <span>Work:</span>
                        <div class="work-item-container" id="workItemsContainer">
                            {/* Content will be generated by script */}
                        </div>
                        <div class="radio-group work-overall-nil-group">
                            <label><input type="radio" name="workOverallNil" value="Nil" id="workNilRadioOverall"> Nil (for entire Work section)</label>
                        </div>
                    </div>
    
                    <div class="form-group">
                        <label>Recommended work level:</label>
                         <div class="radio-group">
                            <label><input type="radio" name="recommendedWorkLevel" value="Open employment"> Open employment</label>
                            <label><input type="radio" name="recommendedWorkLevel" value="SE"> SE</label>
                            <label><input type="radio" name="recommendedWorkLevel" value="SWS"> SWS</label>
                            <label><input type="radio" name="recommendedWorkLevel" value="Not up to any work level"> Not up to any work level</label>
                            <label><input type="radio" name="recommendedWorkLevel" value="No work plan"> No work plan</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ADL:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="adl" value="Independent"> Independent</label>
                            <label><input type="radio" name="adl" value="Standby assistance"> Standby assistance</label>
                            <label><input type="radio" name="adl" value="Minimal assistance"> Minimal assistance</label>
                            <label><input type="radio" name="adl" value="Moderate assistance"> Moderate assistance</label>
                            <label><input type="radio" name="adl" value="Maximal assistance"> Maximal assistance</label>
                            <label><input type="radio" name="adl" value="Dependent"> Dependent</label>
                        </div>
                        MBI: <input type="text" id="adlMbiScore" name="adlMbiScore" class="inline-input small-input"> / 100
                    </div>
                    <div class="form-group">
                        <label>IADL:</label>
                         <div class="radio-group">
                            <label><input type="radio" name="iadlCfna" value="Independent living"> Independent living</label>
                            <label><input type="radio" name="iadlCfna" value="Supervised living"> Supervised living</label>
                            <label><input type="radio" name="iadlCfna" value="Nil"> Nil</label>
                        </div>
                        CFNA: <input type="text" id="iadlCfnaScore" name="iadlCfnaScore" class="inline-input small-input"> / 650
                    </div>
                     <div class="form-group">
                        <label>Domestic:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="domestic" value="adequate domestic skills and knowledge"> adequate domestic skills and knowledge</label>
                            <label><input type="checkbox" name="domestic" value="inadequate domestic skills and knowledge"> inadequate domestic skills and knowledge</label>
                            <label><input type="checkbox" name="domestic" value="adequate planning & organization of task"> adequate planning & organization of task</label>
                            <label><input type="checkbox" name="domestic" value="inadequate planning & organization of task"> inadequate planning & organization of task</label>
                            <label><input type="checkbox" name="domestic" value="adequate safety awareness"> adequate safety awareness</label>
                            <label><input type="checkbox" name="domestic" value="inadequate safety awareness"> inadequate safety awareness</label>
                            <label><input type="checkbox" name="domestic" value="adequate kitchen hygiene"> adequate kitchen hygiene</label>
                            <label><input type="checkbox" name="domestic" value="inadequate kitchen hygiene"> inadequate kitchen hygiene</label>
                            <label><input type="checkbox" name="domestic" value="good time management"> good time management</label>
                            <label><input type="checkbox" name="domestic" value="poor time management"> poor time management</label>
                            <label><input type="checkbox" name="domestic" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Childcare:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="childcare" value="adequate skills and knowledge"> adequate skills and knowledge</label>
                            <label><input type="radio" name="childcare" value="borderline skills and knowledge"> borderline skills and knowledge</label>
                            <label><input type="radio" name="childcare" value="inadequate skills and knowledge"> inadequate skills and knowledge</label>
                            <label><input type="radio" name="childcare" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Cognitive:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="cognitiveTest" value="HK-MoCA"> HK-MoCA <input type="text" name="cognitiveScore_hkMoca" class="inline-input small-input"> /30</label>
                            <label><input type="radio" name="cognitiveTest" value="Hk-MoCA 5"> Hk-MoCA 5 <input type="text" name="cognitiveScore_hkMoca5" class="inline-input small-input"> /30</label>
                            <label><input type="radio" name="cognitiveTest" value="AMT"> AMT <input type="text" name="cognitiveScore_amt" class="inline-input small-input"> /10</label>
                            <label><input type="radio" name="cognitiveTest" value="CFAB"> CFAB <input type="text" name="cognitiveScore_cfab" class="inline-input small-input"> /18</label>
                            <label><input type="radio" name="cognitiveTest" value="HKBC"> HKBC <input type="text" name="cognitiveScore_hkbc" class="inline-input small-input"> /30</label>
                            <label><input type="radio" name="cognitiveTest" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Overall performance:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="overallPerformance" value="Intact Cognitive Functions"> Intact Cognitive Functions</label>
                            <label><input type="radio" name="overallPerformance" value="Impaired Cognitive Functions"> Impaired Cognitive Functions</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Daily functioning:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="dailyFunctioning" value="Not affected"> Not affected</label>
                            <label><input type="radio" name="dailyFunctioning" value="Affected"> Affected</label>
                            <label><input type="radio" name="dailyFunctioning" value="Doubtful"> Doubtful</label>
                        </div>
                    </div>
                </fieldset>
    
                <fieldset>
                    <legend>3. Interventions Provided</legend>
                     <div class="form-group">
                        <label>Work rehabilitation:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionWork" value="Job analysis"> Job analysis</label>
                        <label><input type="checkbox" name="interventionWork" value="Job site visit"> Job site visit</label>
                        <label><input type="checkbox" name="interventionWork" value="Job exploration"> Job exploration</label>
                        <label><input type="checkbox" name="interventionWork" value="Prevocational training"> Prevocational training</label>
                        <label><input type="checkbox" name="interventionWork" value="Returning to work program"> Returning to work program</label>
                        <label><input type="checkbox" name="interventionWork" value="Work capacity evaluation"> Work capacity evaluation</label>
                        <label><input type="checkbox" name="interventionWork" value="Work hardening"> Work hardening</label>
                        <label><input type="checkbox" name="interventionWork" value="Nil"> Nil</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label>Self-management Training:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionSelfMgmt" value="ADL Assessment & training"> ADL Assessment & training</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="IADL Assessment & training"> IADL Assessment & training</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Child care assessment & training"> Child care assessment & training</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Community re-integration"> Community re-integration</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Cooking assessment & training"> Cooking assessment & training</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Illness management"> Illness management</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Relaxation training"> Relaxation training</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Stress management"> Stress management</label>
                        <label><input type="checkbox" name="interventionSelfMgmt" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Interpersonal Skills Training:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionInterpersonal" value="Communication skills training"> Communication skills training</label>
                        <label><input type="checkbox" name="interventionInterpersonal" value="Social skills training"> Social skills training</label>
                        <label><input type="checkbox" name="interventionInterpersonal" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Cognitive Training:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionCognitive" value="Cognitive assessment & training"> Cognitive assessment & training</label>
                        <label><input type="checkbox" name="interventionCognitive" value="Memory assessment & retraining"> Memory assessment & retraining</label>
                        <label><input type="checkbox" name="interventionCognitive" value="Perceptual assessment & retraining"> Perceptual assessment & retraining</label>
                        <label><input type="checkbox" name="interventionCognitive" value="Reality orientation"> Reality orientation</label>
                        <label><input type="checkbox" name="interventionCognitive" value="Computer cognitive training"> Computer cognitive training</label>
                        <label><input type="checkbox" name="interventionCognitive" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Life Coaching:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Counseling"> Counseling</label>
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Cognitive behavioral therapy"> Cognitive behavioral therapy</label>
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Health Qi-gong"> Health Qi-gong</label>
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Lifestyle re-design"> Lifestyle re-design</label>
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Motivational interviewing"> Motivational interviewing</label>
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Wellness program"> Wellness program</label>
                        <label><input type="checkbox" name="interventionLifeCoaching" value="Nil"> Nil</label>
                        </div>
                    </div>
                     <div class="form-group">
                        <label>Behavioral Management Training:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionBehavioral" value="Impulse control"> Impulse control</label>
                        <label><input type="checkbox" name="interventionBehavioral" value="Temper management"> Temper management</label>
                        <label><input type="checkbox" name="interventionBehavioral" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Home Assessment & Modification:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionHome" value="Home assessment"> Home assessment</label>
                        <label><input type="checkbox" name="interventionHome" value="Home visit"> Home visit</label>
                        <label><input type="checkbox" name="interventionHome" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Sensory Based Intervention:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionSensory" value="Desensitization"> Desensitization</label>
                        <label><input type="checkbox" name="interventionSensory" value="Sensory integration"> Sensory integration</label>
                        <label><input type="checkbox" name="interventionSensory" value="Sensory re-education"> Sensory re-education</label>
                        <label><input type="checkbox" name="interventionSensory" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Physical Training:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionPhysical" value="Gross motor training"> Gross motor training</label>
                        <label><input type="checkbox" name="interventionPhysical" value="Fine motor training"> Fine motor training</label>
                        <label><input type="checkbox" name="interventionPhysical" value="UL functional training"> UL functional training</label>
                        <label><input type="checkbox" name="interventionPhysical" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Aids Prescription and Training:</label>
                        <div class="checkbox-group">
                        <label><input type="checkbox" name="interventionAids" value="Aids prescription & training"> Aids prescription & training</label>
                        <label><input type="checkbox" name="interventionAids" value="Pressure relieving devices"> Pressure relieving devices</label>
                        <label><input type="checkbox" name="interventionAids" value="Pressure therapy (garment)"> Pressure therapy (garment)</label>
                        <label><input type="checkbox" name="interventionAids" value="Seating assessment & prescription"> Seating assessment & prescription</label>
                        <label><input type="checkbox" name="interventionAids" value="Splintage"> Splintage</label>
                        <label><input type="checkbox" name="interventionAids" value="Wheelchair prescription & training"> Wheelchair prescription & training</label>
                        <label><input type="checkbox" name="interventionAids" value="Nil"> Nil</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="interventionCaregiverTraining">Caregiver Training on:</label>
                        <input type="text" id="interventionCaregiverTraining" name="interventionCaregiverTraining">
                    </div>
                    <div class="form-group">
                        <label for="interventionOthers">Others, please specify e.g.,</label>
                        <textarea id="interventionOthers" name="interventionOthers"></textarea>
                    </div>
                </fieldset>
    
                <fieldset>
                    <legend>4. Discharged Plan and Recommendations</legend>
                     <div class="form-group">
                        <label>Residential:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="dischargeResidential" value="Home"> Home</label>
                            <label><input type="radio" name="dischargeResidential" value="Subvented or BP- HWH"> Subvented or BP- HWH</label>
                            <label><input type="radio" name="dischargeResidential" value="Subvented or BP-LSCH"> Subvented or BP-LSCH</label>
                            <label><input type="radio" name="dischargeResidential" value="Subvented or BP- Private Hostel"> Subvented or BP- Private Hostel</label>
                            <label><input type="radio" name="dischargeResidential" value="MD hostel"> MD hostel</label>
                            <label><input type="radio" name="dischargeResidential" value="Boarding school"> Boarding school</label>
                            <label><input type="radio" name="dischargeResidential" value="Detox center"> Detox center</label>
                            <label><input type="radio" name="dischargeResidential" value="Foster home"> Foster home</label>
                            <label><input type="radio" name="dischargeResidential" value="Other hospital"> Other hospital</label>
                            <label><input type="radio" name="dischargeResidential" value="Street"> Street</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="dischargeResidentialReco">Recommendation:</label>
                        <input type="text" id="dischargeResidentialReco" name="dischargeResidentialReco" placeholder="continue functional training in “name of the organization, post etc.”">
                    </div>
    
                    <div class="form-group">
                        <label>Vocational:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="dischargeVocational" value="OE"> OE</label>
                            <label><input type="checkbox" name="dischargeVocational" value="PDH"> PDH</label>
                            <label><input type="checkbox" name="dischargeVocational" value="SE"> SE</label>
                            <label><input type="checkbox" name="dischargeVocational" value="SWS"> SWS</label>
                            <label><input type="checkbox" name="dischargeVocational" value="ERB"> ERB</label>
                            <label><input type="checkbox" name="dischargeVocational" value="DAC"> DAC</label>
                            <label><input type="checkbox" name="dischargeVocational" value="IVRSC"> IVRSC</label>
                            <label><input type="checkbox" name="dischargeVocational" value="IVTC"> IVTC</label>
                            <label><input type="checkbox" name="dischargeVocational" value="Skills Center"> Skills Center</label>
                        </div>
                         <label for="dischargeVocationalReferredOn" class="referral-date-label">Referred on:</label>
                        <input type="text" id="dischargeVocationalReferredOn" name="dischargeVocationalReferredOn" class="referral-date-input">
                    </div>
                    <div class="form-group">
                        <label for="dischargeVocationalReco">Recommendation:</label>
                        <input type="text" id="dischargeVocationalReco" name="dischargeVocationalReco" placeholder="continue vocational rehabilitation in “name of the organization, post etc.”">
                    </div>
    
                    <div class="form-group">
                        <label>Daytime engagement:</label>
                         <div class="checkbox-group">
                            <label><input type="checkbox" name="dischargeDaytime" value="ICCMW"> ICCMW</label>
                            <label><input type="checkbox" name="dischargeDaytime" value="DSC"> DSC</label>
                            <label><input type="checkbox" name="dischargeDaytime" value="CCPSA"> CCPSA</label>
                        </div>
                        <label for="dischargeDaytimeReferredOn" class="referral-date-label">Referred on:</label>
                        <input type="text" id="dischargeDaytimeReferredOn" name="dischargeDaytimeReferredOn" class="referral-date-input">
                    </div>
                     <div class="form-group">
                        <label for="dischargeDaytimeReco">Recommendation:</label>
                        <input type="text" id="dischargeDaytimeReco" name="dischargeDaytimeReco" placeholder="continue / counseling / activity / skill training / carer support in “name of the organization”">
                    </div>
    
                    <div class="form-group">
                         <label>Others (PCP related):</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="dischargeOthersPCP" value="PCP"> PCP</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Other recommendations:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="dischargeOthersReco" value="continue Illness management"> continue Illness management</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Lifestyle redesign"> Lifestyle redesign</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Monitoring on treatment compliance"> Monitoring on treatment compliance</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Community support"> Community support</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Social skills training"> Social skills training</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Stress coping"> Stress coping</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Follow up on work rehabilitation"> Follow up on work rehabilitation</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Leisure cultivation"> Leisure cultivation</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Resources linkage"> Resources linkage</label>
                            <label><input type="checkbox" name="dischargeOthersReco" value="Carer support"> Carer support</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="dischargePlanOthersSpecify">Others (discharge plan specify):</label>
                        <textarea id="dischargePlanOthersSpecify" name="dischargePlanOthersSpecify"></textarea>
                    </div>
                </fieldset>
    
                <div class="action-buttons">
                    <button type="button" id="generateReportBtn">Generate Report</button>
                    <button type="button" id="copyReportBtn">Copy Report</button>
                    <button type="button" id="resetFormBtn">Reset Form</button>
                </div>
            </form>
            <textarea id="generatedReport" readonly placeholder="Generated report will appear here..."></textarea>
        </div>

        <div id="ldAssessmentContainer" class="form-section">
            <form id="ldForm">
                <!-- ... LD Assessment Form HTML ... -->
                <fieldset>
                    <legend>Personal</legend>
                    <label for="ld_assessmentDate">Date:</label>
                    <input type="date" id="ld_assessmentDate" name="ld_assessmentDate">
                </fieldset>
            
                <fieldset>
                    <legend>1. Mental State Examination
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_mse"> Exclude from Report</label></span>
                    </legend>
                    <div class="form-row">
                        <div>
                            <label>Comorbidity:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_comorbidity" value="ASD">ASD</label>
                                <label><input type="checkbox" name="ld_comorbidity" value="ADHD">ADHD</label>
                                <label><input type="checkbox" name="ld_comorbidity" value="Schizophrenia">Schizophrenia</label>
                                <label><input type="checkbox" name="ld_comorbidity" value="Depression">Depression</label>
                                <label><input type="checkbox" name="ld_comorbidity" value="BAD">BAD</label>
                                <label><input type="checkbox" name="ld_comorbidity" value="Dementia">Dementia</label>
                            </div>
                            <label for="ld_comorbidity_others">Others:</label>
                            <input type="text" id="ld_comorbidity_others" name="ld_comorbidity_others">
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Mood:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_mood" value="Neutral">Neutral</label>
                                <label><input type="checkbox" name="ld_mood" value="Depressed">Depressed</label>
                                <label><input type="checkbox" name="ld_mood" value="Dysthymic">Dysthymic</label>
                                <label><input type="checkbox" name="ld_mood" value="Euthymic">Euthymic</label>
                                <label><input type="checkbox" name="ld_mood" value="Elated">Elated</label>
                                <label><input type="checkbox" name="ld_mood" value="Irritable">Irritable</label>
                                <label><input type="checkbox" name="ld_mood" value="Anxious">Anxious</label>
                            </div>
                            <label for="ld_mood_others">Others:</label>
                            <input type="text" id="ld_mood_others" name="ld_mood_others">
                        </div>
                        <div>
                            <label>Affect:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_affect" value="Congruent">Congruent</label>
                                <label><input type="checkbox" name="ld_affect" value="Labile">Labile</label>
                                <label><input type="checkbox" name="ld_affect" value="Shallow">Shallow</label>
                                <label><input type="checkbox" name="ld_affect" value="Blunted">Blunted</label>
                                <label><input type="checkbox" name="ld_affect" value="Restricted">Restricted</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Receptive Speech:</label>
                            <div class="inline-fields checkbox-group">
                                <label>Follow</label> <input type="number" id="ld_receptive_steps" name="ld_receptive_steps" style="width: 70px;"> <label>step</label>
                                <select id="ld_receptive_command_type" name="ld_receptive_command_type" style="width: auto;">
                                    <option value="verbal">verbal</option>
                                    <option value="gestural">gestural</option>
                                </select> <label>command</label>
                                <br>
                                <label><input type="checkbox" name="ld_receptive_speech_options" value="Repeat verbal command">Repeat verbal command</label>
                                <label><input type="checkbox" name="ld_receptive_speech_options" value="Not following command">Not following command</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Expressive Speech:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_expressive_speech" value="Relevant">Relevant</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Coherent">Coherent</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Spontaneous">Spontaneous</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Pressured">Pressured</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Slurred">Slurred</label>
                                <br>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Circumstantial">Circumstantial</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Tangential">Tangential</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Brief">Brief</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Echolalia">Echolalia</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="No meaningful speech">No meaningful speech</label>
                                <label><input type="checkbox" name="ld_expressive_speech" value="Mute">Mute</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Hallucination:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_hallucination" value="Auditory">Auditory</label>
                                <label><input type="checkbox" name="ld_hallucination" value="Visual">Visual</label>
                                <label><input type="checkbox" name="ld_hallucination" value="Olfactory">Olfactory</label>
                                <label><input type="checkbox" name="ld_hallucination" value="Tactile">Tactile</label>
                                <label><input type="checkbox" name="ld_hallucination" value="Gustatory">Gustatory</label>
                                <label><input type="checkbox" id="ld_hallucination_nil" name="ld_hallucination" value="Nil">Nil</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Abnormal Thought:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Persecutory">Persecutory</label>
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Delusional">Delusional</label>
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Somatic">Somatic</label>
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Grandiose">Grandiose</label>
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Idea of reference">Idea of reference</label>
                                <br>
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Thought broadcasting">Thought broadcasting</label>
                                <label><input type="checkbox" name="ld_abnormal_thought" value="Being control">Being control</label>
                                <label><input type="checkbox" id="ld_abnormal_thought_nil" name="ld_abnormal_thought" value="Nil">Nil</label>
                            </div>
                            <label for="ld_abnormal_thought_others">Other, please specify:</label>
                            <input type="text" id="ld_abnormal_thought_others" name="ld_abnormal_thought_others">
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Behaviour:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_behaviour" value="Normal">Normal</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Bizarre">Bizarre</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Self-muttering">Self-muttering</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Self-giggling">Self-giggling</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Disturbing">Disturbing</label>
                                <br>
                                <label><input type="checkbox" name="ld_behaviour" value="Disorganized">Disorganized</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Disinhibited">Disinhibited</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Violent">Violent</label>
                                <label><input type="checkbox" name="ld_behaviour" value="Self-stimulating">Self-stimulating</label>
                            </div>
                            <label for="ld_behaviour_others">Others:</label>
                            <input type="text" id="ld_behaviour_others" name="ld_behaviour_others">
                        </div>
                        <div>
                            <label>Cognitive:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_cognitive" value="Oriented">Oriented</label>
                                <label><input type="checkbox" name="ld_cognitive" value="Disoriented">Disoriented</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label>Risk:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_risk" value="Suicidal">Suicidal</label>
                                <label><input type="checkbox" name="ld_risk" value="Homicidal">Homicidal</label>
                                <label><input type="checkbox" name="ld_risk" value="Self-harm">Self-harm</label>
                                <label><input type="checkbox" name="ld_risk" value="Self-neglect">Self-neglect</label>
                                <label><input type="checkbox" name="ld_risk" value="Violent">Violent</label>
                                <label><input type="checkbox" name="ld_risk" value="Environmental destruction">Environmental destruction</label>
                                <label><input type="checkbox" id="ld_risk_nil" name="ld_risk" value="Nil">Nil</label>
                            </div>
                        </div>
                        <div>
                            <label>Insight:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_insight" value="Full">Full</label>
                                <label><input type="checkbox" name="ld_insight" value="Partial">Partial</label>
                                <label><input type="checkbox" name="ld_insight" value="Limited">Limited</label>
                                <label><input type="checkbox" name="ld_insight" value="Poor">Poor</label>
                            </div>
                        </div>
                    </div>
                    <label for="ld_mse_others_remarks">Others/Remarks:</label>
                    <textarea id="ld_mse_others_remarks" name="ld_mse_others_remarks"></textarea>
                </fieldset>
            
                <fieldset>
                    <legend>2. Physical Assessment
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_pa"> Exclude from Report</label></span>
                    </legend>
                    <h4>General</h4>
                    <div class="form-row">
                        <div>
                            <label>Wound:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="ld_wound_present" value="Y">Y</label>
                                <label><input type="radio" name="ld_wound_present" value="N" checked>N</label>
                            </div>
                        </div>
                        <div>
                            <label>Type:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_wound_type" value="Abrasion">Abrasion</label>
                                <label><input type="checkbox" name="ld_wound_type" value="Laceration">Laceration</label>
                                <label><input type="checkbox" name="ld_wound_type" value="Scratch">Scratch</label>
                                <label><input type="checkbox" name="ld_wound_type" value="Bruise">Bruise</label>
                                <label><input type="checkbox" name="ld_wound_type" value="Hematoma">Hematoma</label>
                                <label><input type="checkbox" name="ld_wound_type" value="Blister">Blister</label>
                            </div>
                            <label for="ld_wound_type_others">Others:</label>
                            <input type="text" id="ld_wound_type_others" name="ld_wound_type_others">
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label for="ld_wound_location">Location:</label>
                            <input type="text" id="ld_wound_location" name="ld_wound_location">
                        </div>
                         <div>
                            <label>On dressing:</label>
                             <div class="radio-group">
                                <label><input type="radio" name="ld_wound_dressing" value="Yes">Yes</label>
                                <label><input type="radio" name="ld_wound_dressing" value="No" checked>No</label>
                            </div>
                        </div>
                    </div>
                    <label for="ld_general_other_observation">Other observation:</label>
                    <textarea id="ld_general_other_observation" name="ld_general_other_observation"></textarea>
                    
                    <div class="limb-range-section">
                        <h4>Range & Contracture/Deformity</h4>
                        <div class="form-row"> 
                            <div>Limb</div>
                            <div>AROM / Functional</div>
                            <div>PROM</div>
                            <div>Contracture/Deformity</div>
                        </div>
                        <div class="limb-data-row">
                            <div class="limb-name">RUL:</div>
                            <div class="arom-group">
                                <label for="ld_rul_arom">AROM:</label>
                                <input type="text" id="ld_rul_arom" name="ld_rul_arom">
                                <label class="functional-cb-label"><input type="checkbox" id="ld_rul_arom_functional" name="ld_rul_arom_functional"> Functional</label>
                            </div>
                            <div class="prom-group">
                                <label for="ld_rul_prom">PROM:</label>
                                <input type="text" id="ld_rul_prom" name="ld_rul_prom">
                            </div>
                            <div class="contracture-group">
                                <label>Contracture/Deformity:</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="ld_rul_contracture" value="Y">Y</label>
                                    <label><input type="radio" name="ld_rul_contracture" value="N" checked>N</label>
                                </div>
                            </div>
                        </div>
                        <div class="limb-data-row">
                            <div class="limb-name">LUL:</div>
                            <div class="arom-group">
                                <label for="ld_lul_arom">AROM:</label>
                                <input type="text" id="ld_lul_arom" name="ld_lul_arom">
                                <label class="functional-cb-label"><input type="checkbox" id="ld_lul_arom_functional" name="ld_lul_arom_functional"> Functional</label>
                            </div>
                            <div class="prom-group">
                                <label for="ld_lul_prom">PROM:</label>
                                <input type="text" id="ld_lul_prom" name="ld_lul_prom">
                            </div>
                            <div class="contracture-group">
                                <label>Contracture/Deformity:</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="ld_lul_contracture" value="Y">Y</label>
                                    <label><input type="radio" name="ld_lul_contracture" value="N" checked>N</label>
                                </div>
                            </div>
                        </div>
                        <div class="limb-data-row">
                            <div class="limb-name">RLL:</div>
                            <div class="arom-group">
                                <label for="ld_rll_arom">AROM:</label>
                                <input type="text" id="ld_rll_arom" name="ld_rll_arom">
                                <label class="functional-cb-label"><input type="checkbox" id="ld_rll_arom_functional" name="ld_rll_arom_functional"> Functional</label>
                            </div>
                            <div class="prom-group">
                                <label for="ld_rll_prom">PROM:</label>
                                <input type="text" id="ld_rll_prom" name="ld_rll_prom">
                            </div>
                            <div class="contracture-group">
                                <label>Contracture/Deformity:</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="ld_rll_contracture" value="Y">Y</label>
                                    <label><input type="radio" name="ld_rll_contracture" value="N" checked>N</label>
                                </div>
                            </div>
                        </div>
                        <div class="limb-data-row">
                            <div class="limb-name">LLL:</div>
                            <div class="arom-group">
                                <label for="ld_lll_arom">AROM:</label>
                                <input type="text" id="ld_lll_arom" name="ld_lll_arom">
                                <label class="functional-cb-label"><input type="checkbox" id="ld_lll_arom_functional" name="ld_lll_arom_functional"> Functional</label>
                            </div>
                            <div class="prom-group">
                                <label for="ld_lll_prom">PROM:</label>
                                <input type="text" id="ld_lll_prom" name="ld_lll_prom">
                            </div>
                            <div class="contracture-group">
                                <label>Contracture/Deformity:</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="ld_lll_contracture" value="Y">Y</label>
                                    <label><input type="radio" name="ld_lll_contracture" value="N" checked>N</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <label for="ld_pa_contracture_details">Contracture/Deformity details (e.g. specific joints):</label>
                    <input type="text" id="ld_pa_contracture_details" name="ld_pa_contracture_details">
            
                    <h4>Strength (MMT)</h4>
                    <div class="form-row">
                        <div><label for="ld_rul_mmt">RUL MMT:</label><input type="text" id="ld_rul_mmt" name="ld_rul_mmt"></div>
                        <div><label for="ld_lul_mmt">LUL MMT:</label><input type="text" id="ld_lul_mmt" name="ld_lul_mmt"></div>
                        <div><label for="ld_rll_mmt">RLL MMT:</label><input type="text" id="ld_rll_mmt" name="ld_rll_mmt"></div>
                        <div><label for="ld_lll_mmt">LLL MMT:</label><input type="text" id="ld_lll_mmt" name="ld_lll_mmt"></div>
                    </div>
                    <h4>Fine Motor</h4>
                    <p>Check if present (√)</p>
                    <div class="fine-motor-grid">
                        <span></span><span class="fm-header">Grasp</span><span class="fm-header">Opposition</span><span class="fm-header">Pinch grip</span><span class="fm-header">Hand writing</span>
                        <span class="limb-header">RUL:</span>
                        <label><input type="checkbox" id="ld_rul_grasp" name="ld_rul_grasp"></label>
                        <label><input type="checkbox" id="ld_rul_opposition" name="ld_rul_opposition"></label>
                        <label><input type="checkbox" id="ld_rul_pinch_grip" name="ld_rul_pinch_grip"></label>
                        <label><input type="checkbox" id="ld_rul_hand_writing" name="ld_rul_hand_writing"></label>
                        <span class="limb-header">LUL:</span>
                        <label><input type="checkbox" id="ld_lul_grasp" name="ld_lul_grasp"></label>
                        <label><input type="checkbox" id="ld_lul_opposition" name="ld_lul_opposition"></label>
                        <label><input type="checkbox" id="ld_lul_pinch_grip" name="ld_lul_pinch_grip"></label>
                        <label><input type="checkbox" id="ld_lul_hand_writing" name="ld_lul_hand_writing"></label>
                    </div>
                </fieldset>
            
                <fieldset>
                    <legend>3. Sensory Assessment
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_sa"> Exclude from Report</label></span>
                    </legend>
                    <table>
                        <thead><tr><th>Observation</th><th>Hypersensitivity</th><th>Hyposensitivity</th><th>Sensory Seeking</th></tr></thead>
                        <tbody>
                            <tr><td><strong>Auditory</strong></td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_auditory_hyper" value="Covering ears">Covering ears to block out sounds</label><br>
                                    <label><input type="checkbox" name="ld_auditory_hyper" value="Overwhelmed by loud/unexpected noises">Overwhelmed by loud or unexpected noises</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_auditory_hypo" value="Not responding to sounds">Not responding to sounds</label><br>
                                    <label><input type="checkbox" name="ld_auditory_hypo" value="Unaware of salient auditory stimuli">Unaware of auditory stimuli that are salient to others</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_auditory_seeking" value="Enjoying loud noises">Enjoying loud noises and making them</label><br>
                                    <label><input type="checkbox" name="ld_auditory_seeking" value="Thriving in loud environments">Thriving in loud environments</label>
                                </td></tr>
                            <tr><td><strong>Visual</strong></td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_visual_hyper" value="Discomfort with bright lights/patterns">Discomfort with bright lights or certain visual patterns</label><br>
                                    <label><input type="checkbox" name="ld_visual_hyper" value="Avoiding eye contact/shielding eyes">Avoiding eye contact or shielding eyes</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_visual_hypo" value="Lack of response to visual stimuli">Lack of response to visual stimuli</label><br>
                                    <label><input type="checkbox" name="ld_visual_hypo" value="Not noticing objects">Not noticing objects in their environment</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_visual_seeking" value="Staring at shiny/colourful objects">Staring at shiny or colourful objects</label><br>
                                    <label><input type="checkbox" name="ld_visual_seeking" value="Waving/placing objects close to eyes">Waving or placing objects very close to their eyes</label>
                                </td></tr>
                            <tr><td><strong>Oral</strong></td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_oral_hyper" value="Aversion to certain food textures/tastes">Aversion to certain food textures or tastes</label><br>
                                    <label><input type="checkbox" name="ld_oral_hyper" value="Gagging/vomiting to certain foods">Gagging or vomiting in response to certain foods</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_oral_hypo" value="Seeking out intense flavours">Seeking out intense flavours</label><br>
                                    <label><input type="checkbox" name="ld_oral_hypo" value="Not noticing food temperature">Not noticing food temperature</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_oral_seeking" value="Chewing on non-food items">Chewing on non-food items</label><br>
                                    <label><input type="checkbox" name="ld_oral_seeking" value="Preferring strong-tasting foods">Preferring strong-tasting foods</label>
                                </td></tr>
                            <tr><td><strong>Tactile</strong></td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_tactile_hyper" value="Discomfort with certain textures">Discomfort with certain textures</label><br>
                                    <label><input type="checkbox" name="ld_tactile_hyper" value="Avoiding specific clothing/touch">Avoiding specific clothing or refusing to touch certain materials</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_tactile_hypo" value="Seeking out intense tactile experiences">Seeking out intense tactile experiences</label><br>
                                    <label><input type="checkbox" name="ld_tactile_hypo" value="Not noticing pain">Not noticing pain</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_tactile_seeking" value="Enjoying being touched/massaged">Enjoying being touched, massaged, tickled, and hugged</label><br>
                                    <label><input type="checkbox" name="ld_tactile_seeking" value="Walking barefoot everywhere">Walking barefoot everywhere</label>
                                </td></tr>
                            <tr><td><strong>Proprioception</strong></td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_proprioception_hyper" value="Discomfort with certain movements/positions">Discomfort with certain movements or positions</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_proprioception_hypo" value="Poor body awareness">Poor body awareness</label><br>
                                    <label><input type="checkbox" name="ld_proprioception_hypo" value="Clumsiness in movement">Clumsiness in movement</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_proprioception_seeking" value="Pushing others or objects">Pushing others or objects</label><br>
                                    <label><input type="checkbox" name="ld_proprioception_seeking" value="Crashing, falling, running">Crashing, falling, running</label>
                                </td></tr>
                            <tr><td><strong>Vestibular</strong></td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_vestibular_hyper" value="Hypersensitivity to movement">Hypersensitivity to movement</label><br>
                                    <label><input type="checkbox" name="ld_vestibular_hyper" value="Poor motor coordination/balance">Poor motor coordination and balance</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_vestibular_hypo" value="Seeking out intense movement experiences">Seeking out intense movement experiences</label><br>
                                    <label><input type="checkbox" name="ld_vestibular_hypo" value="Delayed developmental milestones (sitting/walking)">Delayed developmental milestones like sitting/walking</label>
                                </td>
                                <td class="checkbox-group">
                                    <label><input type="checkbox" name="ld_vestibular_seeking" value="Rocking back and forth">Rocking back and forth</label><br>
                                    <label><input type="checkbox" name="ld_vestibular_seeking" value="Swinging their legs">Swinging their legs</label>
                                </td></tr>
                        </tbody>
                    </table>
                    <label for="ld_sensory_assessment_others">Others (Examples/Observations for report):</label>
                    <textarea id="ld_sensory_assessment_others" name="ld_sensory_assessment_others"></textarea>
                    <h4>Sensory Profile
                         <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_sensory_profile"> Exclude from Report</label></span>
                    </h4>
                    <label for="ld_sensory_profile_informant">Informant:</label>
                    <input type="text" id="ld_sensory_profile_informant" name="ld_sensory_profile_informant">
                    <div class="grid-container">
                        <div class="grid-item">
                            <label>Low Registration: <input type="number" id="ld_sp_low_reg_score" name="ld_sp_low_reg_score" style="width: 70px;"> /75</label>
                            <div class="checkbox-group">
                                Less Than Others: <label><input type="checkbox" name="ld_sp_low_reg_interpretation" value="Definite Difference (Less)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_low_reg_interpretation" value="Probable Difference (Less)">Probable Difference</label><br>
                                <label><input type="checkbox" name="ld_sp_low_reg_interpretation" value="Typical Performance">Typical Performance</label><br>
                                More Than Others: <label><input type="checkbox" name="ld_sp_low_reg_interpretation" value="Definite Difference (More)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_low_reg_interpretation" value="Probable Difference (More)">Probable Difference</label>
                            </div>
                        </div>
                        <div class="grid-item">
                            <label>Sensation Seeking: <input type="number" id="ld_sp_sensation_seeking_score" name="ld_sp_sensation_seeking_score" style="width: 70px;"> /75</label>
                            <div class="checkbox-group">
                                Less Than Others: <label><input type="checkbox" name="ld_sp_sensation_seeking_interpretation" value="Definite Difference (Less)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_sensation_seeking_interpretation" value="Probable Difference (Less)">Probable Difference</label><br>
                                <label><input type="checkbox" name="ld_sp_sensation_seeking_interpretation" value="Typical Performance">Typical Performance</label><br>
                                More Than Others: <label><input type="checkbox" name="ld_sp_sensation_seeking_interpretation" value="Definite Difference (More)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_sensation_seeking_interpretation" value="Probable Difference (More)">Probable Difference</label>
                            </div>
                        </div>
                        <div class="grid-item">
                            <label>Sensory Sensitive: <input type="number" id="ld_sp_sensory_sensitive_score" name="ld_sp_sensory_sensitive_score" style="width: 70px;"> /75</label>
                            <div class="checkbox-group">
                                Less Than Others: <label><input type="checkbox" name="ld_sp_sensory_sensitive_interpretation" value="Definite Difference (Less)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_sensory_sensitive_interpretation" value="Probable Difference (Less)">Probable Difference</label><br>
                                <label><input type="checkbox" name="ld_sp_sensory_sensitive_interpretation" value="Typical Performance">Typical Performance</label><br>
                                More Than Others: <label><input type="checkbox" name="ld_sp_sensory_sensitive_interpretation" value="Definite Difference (More)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_sensory_sensitive_interpretation" value="Probable Difference (More)">Probable Difference</label>
                            </div>
                        </div>
                        <div class="grid-item">
                            <label>Sensory Avoidance: <input type="number" id="ld_sp_sensory_avoidance_score" name="ld_sp_sensory_avoidance_score" style="width: 70px;"> /75</label>
                            <div class="checkbox-group">
                                Less Than Others: <label><input type="checkbox" name="ld_sp_sensory_avoidance_interpretation" value="Definite Difference (Less)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_sensory_avoidance_interpretation" value="Probable Difference (Less)">Probable Difference</label><br>
                                <label><input type="checkbox" name="ld_sp_sensory_avoidance_interpretation" value="Typical Performance">Typical Performance</label><br>
                                More Than Others: <label><input type="checkbox" name="ld_sp_sensory_avoidance_interpretation" value="Definite Difference (More)">Definite Difference</label> <label><input type="checkbox" name="ld_sp_sensory_avoidance_interpretation" value="Probable Difference (More)">Probable Difference</label>
                            </div>
                        </div>
                    </div>
                </fieldset>
            
                <fieldset>
                    <legend>4. Behavioural Assessment
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_ba"> Exclude from Report</label></span>
                    </legend>
                    <h4>Motivational Assessment Scale (MAS)
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_mas"> Exclude from Report</label></span>
                    </h4>
                    <label for="ld_mas_target_behaviour_overall">Target Behaviour (Overall for MAS):</label>
                    <input type="text" id="ld_mas_target_behaviour_overall" name="ld_mas_target_behaviour_overall">
            
                    <div class="mas-function-group">
                        <h5>Sensory</h5>
                        <div><label for="ld_mas_sensory_total">Total Score:</label> <input type="number" id="ld_mas_sensory_total" class="ld-mas-total-score"></div>
                        <div><label for="ld_mas_sensory_average">Average Score:</label> <input type="text" id="ld_mas_sensory_average" readonly></div>
                        <div><label for="ld_mas_sensory_ranking">Relative Ranking:</label> <input type="text" id="ld_mas_sensory_ranking" readonly></div>
                    </div>
                    <div class="mas-function-group">
                        <h5>Escape</h5>
                        <div><label for="ld_mas_escape_total">Total Score:</label> <input type="number" id="ld_mas_escape_total" class="ld-mas-total-score"></div>
                        <div><label for="ld_mas_escape_average">Average Score:</label> <input type="text" id="ld_mas_escape_average" readonly></div>
                        <div><label for="ld_mas_escape_ranking">Relative Ranking:</label> <input type="text" id="ld_mas_escape_ranking" readonly></div>
                    </div>
                    <div class="mas-function-group">
                        <h5>Attention</h5>
                        <div><label for="ld_mas_attention_total">Total Score:</label> <input type="number" id="ld_mas_attention_total" class="ld-mas-total-score"></div>
                        <div><label for="ld_mas_attention_average">Average Score:</label> <input type="text" id="ld_mas_attention_average" readonly></div>
                        <div><label for="ld_mas_attention_ranking">Relative Ranking:</label> <input type="text" id="ld_mas_attention_ranking" readonly></div>
                    </div>
                    <div class="mas-function-group">
                        <h5>Tangible</h5>
                        <div><label for="ld_mas_tangible_total">Total Score:</label> <input type="number" id="ld_mas_tangible_total" class="ld-mas-total-score"></div>
                        <div><label for="ld_mas_tangible_average">Average Score:</label> <input type="text" id="ld_mas_tangible_average" readonly></div>
                        <div><label for="ld_mas_tangible_ranking">Relative Ranking:</label> <input type="text" id="ld_mas_tangible_ranking" readonly></div>
                    </div>
            
                    <h4>Challenging Behaviour Interview (CBI)
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_cbi"> Exclude from Report</label></span>
                    </h4>
                    <label for="ld_cbi_target_behaviour">Target Behaviour (Patient's major challenging behaviour):</label>
                    <input type="text" id="ld_cbi_target_behaviour" name="ld_cbi_target_behaviour">
                    <label for="ld_cbi_total_score">Total Score: <input type="text" id="ld_cbi_total_score" name="ld_cbi_total_score" style="width: 70px;"> /55</label>
                </fieldset>
            
                <fieldset>
                    <legend>5. Environmental Assessment
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_ea"> Exclude from Report</label></span>
                    </legend>
                    <h4>Background</h4>
                    <label>Lives with:</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="ld_lives_with" value="Alone">Alone</label>
                        <label><input type="checkbox" name="ld_lives_with" value="Parents">Parents</label>
                        <label><input type="checkbox" name="ld_lives_with" value="Private Hostel">Private Hostel</label>
                        <label><input type="checkbox" name="ld_lives_with" value="HWH">HWH</label>
                        <label><input type="checkbox" name="ld_lives_with" value="HMMH">HMMH</label>
                        <label><input type="checkbox" name="ld_lives_with" value="HSMH">HSMH</label>
                        <label><input type="checkbox" name="ld_lives_with" value="Boarding School">Boarding School</label>
                    </div>
                    <label for="ld_lives_with_others">Others:</label>
                    <input type="text" id="ld_lives_with_others" name="ld_lives_with_others">
                    
                    <h4>Home visit / Hostel Environment
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_home_visit_env"> Exclude from Report</label></span>
                    </h4>
                    <div id="ld_home_visit_env_content"> 
                        <div class="form-row">
                            <div>
                                <label>Lighting:</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="ld_env_lighting" value="Adequate">Adequate</label>
                                    <label><input type="checkbox" name="ld_env_lighting" value="Inadequate">Inadequate</label>
                                    <label><input type="checkbox" name="ld_env_lighting" value="Over-lighting">Over-lighting</label>
                                </div>
                            </div>
                            <div>
                                <label>Noise:</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="ld_env_noise" value="Quiet">Quiet</label>
                                    <label><input type="checkbox" name="ld_env_noise" value="Moderate noise">Moderate noise</label>
                                    <label><input type="checkbox" name="ld_env_noise" value="High noise">High noise</label>
                                    <label><input type="checkbox" name="ld_env_noise" value="Quiet zone/ Pad room available">Quiet zone/ Pad room available</label>
                                    <label><input type="checkbox" name="ld_env_noise_not_available" value="Quiet zone/ Pad room was not available">Quiet zone/ Pad room NOT available</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div>
                                <label>Safety Hazard:</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="ld_env_safety_hazard" value="Fall">Fall</label>
                                    <label><input type="checkbox" name="ld_env_safety_hazard" value="Access to sharps">Access to sharps</label>
                                    <label><input type="checkbox" name="ld_env_safety_hazard" value="Access to poison">Access to poison</label>
                                    <label><input type="checkbox" name="ld_env_safety_hazard_not_presented" value="Not presented">Not presented</label>
                                </div>
                                <label for="ld_env_safety_hazard_others">Others / Describe if +ve:</label>
                                <input type="text" id="ld_env_safety_hazard_others" name="ld_env_safety_hazard_others">
                            </div>
                            <div>
                                <label>Social stimulation:</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="ld_env_social_stimulation" value="Provocation from co-resident">Provocation from co-resident</label>
                                    <label><input type="checkbox" name="ld_env_social_stimulation" value="Social isolation">Social isolation</label>
                                </div>
                                <label for="ld_env_social_stimulation_others">Others (e.g. social over-stimulation):</label>
                                <input type="text" id="ld_env_social_stimulation_others" name="ld_env_social_stimulation_others">
                            </div>
                        </div>
                        <div class="form-row">
                            <div>
                                <label>Change of environment:</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="ld_env_change" value="Change of physical environment">Change of physical environment</label>
                                    <label><input type="checkbox" name="ld_env_change" value="Routine changes">Routine changes</label>
                                    <label><input type="checkbox" name="ld_env_change" value="Carer changes">Carer changes</label>
                                </div>
                                <label for="ld_env_change_others">Others / Specify:</label>
                                <input type="text" id="ld_env_change_others" name="ld_env_change_others">
                            </div>
                        </div>
                        
                        <h5>Staff / Parent Interaction</h5>
                         <div class="form-row">
                            <div>
                                <label>Staff handling:</label>
                                 <div class="checkbox-group">
                                    <label><input type="checkbox" name="ld_staff_handling_type" value="Inconsistent handling">Inconsistent handling</label>
                                    <label><input type="checkbox" name="ld_staff_handling_type" value="Firm handling">Firm handling</label>
                                </div>
                                <label for="ld_staff_handling_others">Others:</label>
                                <input type="text" id="ld_staff_handling_others" name="ld_staff_handling_others">
                            </div>
                            <div>
                                <label for="ld_staff_expectation_behaviour">Staff's expectation on behaviour:</label>
                                <input type="text" id="ld_staff_expectation_behaviour" name="ld_staff_expectation_behaviour">
                            </div>
                        </div>
                        <label for="ld_staff_parents_concern">Hostel staff/ parents concerned about patient's behaviour of (most concerned behaviour):</label>
                        <input type="text" id="ld_staff_parents_concern" name="ld_staff_parents_concern">
                        <label for="ld_staff_parents_response">In response to patient's challenging behaviours, hostel staff/ parents would (staff measures) with satisfactory/ suboptimal effect:</label>
                        <textarea id="ld_staff_parents_response" name="ld_staff_parents_response"></textarea>
            
                        <h5>Restrain Policy (if applicable)</h5>
                        <label>Restrain:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="ld_restrain_policy" value="Yes">Yes</label>
                            <label><input type="radio" name="ld_restrain_policy" value="No" checked>No</label>
                        </div>
                        <div class="sub-section" id="ld_restrain_details_section" style="display:none;">
                            <label>Restrain period:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_restrain_period" value="Daytime">Daytime</label>
                                <label><input type="checkbox" name="ld_restrain_period" value="Day training">Day training</label>
                                <label><input type="checkbox" name="ld_restrain_period" value="Nighttime">Nighttime</label>
                                <label><input type="checkbox" name="ld_restrain_period" value="Sleep">Sleep</label>
                            </div>
                            <label for="ld_restrain_period_others">Others:</label>
                            <input type="text" id="ld_restrain_period_others" name="ld_restrain_period_others">
                            <label for="ld_restrain_situation">Situation of restrain:</label>
                            <textarea id="ld_restrain_situation" name="ld_restrain_situation"></textarea>
                            <label>Body part on restrain:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_restrain_body_part" value="Waist">Waist</label>
                                <label><input type="checkbox" name="ld_restrain_body_part" value="Wrist">Wrist</label>
                                <label><input type="checkbox" name="ld_restrain_body_part" value="Hand">Hand</label>
                                <label><input type="checkbox" name="ld_restrain_body_part" value="Ankle">Ankle</label>
                                <label><input type="checkbox" name="ld_restrain_body_part" value="Upper body">Upper body</label>
                                <label><input type="checkbox" name="ld_restrain_body_part" value="Lower body">Lower body</label>
                            </div>
                            <label for="ld_restrain_body_part_others">Others:</label>
                            <input type="text" id="ld_restrain_body_part_others" name="ld_restrain_body_part_others">
                            <label>Restrainer type:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_restrainer_type" value="Magnetic belt">Magnetic belt</label>
                                <label><input type="checkbox" name="ld_restrainer_type" value="Fabric belt">Fabric belt</label>
                                <label><input type="checkbox" name="ld_restrainer_type" value="Special garment (Upper/Lower)">Special garment (Upper/Lower)</label>
                                <label><input type="checkbox" name="ld_restrainer_type" value="Boxing gloves">Boxing gloves</label>
                                <label><input type="checkbox" name="ld_restrainer_type" value="Chair-table">Chair-table</label>
                            </div>
                            <label for="ld_restrainer_type_others">Others:</label>
                            <input type="text" id="ld_restrainer_type_others" name="ld_restrainer_type_others">
                            <label for="ld_restrain_other_info">Other information:</label>
                            <textarea id="ld_restrain_other_info" name="ld_restrain_other_info"></textarea>
                        </div>
            
                        <h5>Family Involvement</h5>
                        <label for="ld_parent_visit_frequency">Parents would/ would not provide visit to hostel (frequency):</label>
                        <input type="text" id="ld_parent_visit_frequency" name="ld_parent_visit_frequency">
                        <label for="ld_patient_behaviour_visit">Before/ after the visit, patient remained calm and settled/ showed agitation/ showed challenging behaviour of (problem behaviour):</label>
                        <input type="text" id="ld_patient_behaviour_visit" name="ld_patient_behaviour_visit">
                        <label>Parenting style:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="ld_parenting_style" value="Authoritative">Authoritative</label>
                            <label><input type="checkbox" name="ld_parenting_style" value="Authoritarian">Authoritarian</label>
                            <label><input type="checkbox" name="ld_parenting_style" value="Permissive">Permissive</label>
                            <label><input type="checkbox" name="ld_parenting_style" value="Uninvolved">Uninvolved</label>
                        </div>
                        <label for="ld_parenting_style_other_info">Other information:</label>
                        <textarea id="ld_parenting_style_other_info" name="ld_parenting_style_other_info"></textarea>
                    </div> 
                    <label for="ld_env_others_layout">Others (e.g. Layout):</label>
                    <textarea id="ld_env_others_layout" name="ld_env_others_layout"></textarea>
                </fieldset>
                
                <fieldset>
                    <legend>Occupation</legend>
                    <textarea id="ld_occupation_details" name="ld_occupation_details"></textarea>
                </fieldset>
            
                <fieldset>
                    <legend>6. Independent Function Assessment
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_ifa"> Exclude from Report</label></span>
                    </legend>
                    <h4>BADL (MBI)
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_badl_mbi"> Exclude from Report</label></span>
                    </h4>
                    <div class="grid-container">
                        <div><label>Feeding: <input type="number" name="ld_mbi_feeding" class="ld-mbi-score-field"> /10</label></div>
                        <div><label>Grooming: <input type="number" name="ld_mbi_grooming" class="ld-mbi-score-field"> /5</label></div>
                        <div><label>Dressing: <input type="number" name="ld_mbi_dressing" class="ld-mbi-score-field"> /10</label></div>
                        <div><label>Toileting: <input type="number" name="ld_mbi_toileting" class="ld-mbi-score-field"> /10</label></div>
                        <div><label>Bathing: <input type="number" name="ld_mbi_bathing" class="ld-mbi-score-field"> /5</label></div>
                        <div><label>Transfer: <input type="number" name="ld_mbi_transfer" class="ld-mbi-score-field"> /15</label></div>
                        <div><label>Bladder: <input type="number" name="ld_mbi_bladder" class="ld-mbi-score-field"> /10</label></div>
                        <div><label>Bowel: <input type="number" name="ld_mbi_bowel" class="ld-mbi-score-field"> /10</label></div>
                        <div><label>Ambulation: <input type="number" name="ld_mbi_ambulation" class="ld-mbi-score-field"> /15</label></div>
                        <div><label>Stairs: <input type="number" name="ld_mbi_stairs" class="ld-mbi-score-field"> /10</label></div>
                    </div>
                    <label>Total MBI Score: <input type="text" id="ld_mbi_total_score_display" name="ld_mbi_total_score_display" readonly> /100</label>
                    
                    <p><em>Qualitative BADL Levels:</em></p>
                    <div class="form-row">
                        <div>
                            <label for="ld_badl_feeding_level">Feeding:</label>
                            <select id="ld_badl_feeding_level" name="ld_badl_feeding_level">
                                <option value="">Select Level</option><option value="Independent">Independent</option><option value="Supervision">Supervision</option><option value="Mild Assist">Mild Assist</option><option value="Mod Assist">Mod Assist</option><option value="Max Assist">Max Assist</option><option value="Dependent">Dependent</option>
                            </select>
                        </div>
                        <div>
                            <label for="ld_badl_grooming_level">Grooming:</label>
                            <select id="ld_badl_grooming_level" name="ld_badl_grooming_level">
                                <option value="">Select Level</option><option value="Independent">Independent</option><option value="Supervision">Supervision</option><option value="Mild Assist">Mild Assist</option><option value="Mod Assist">Mod Assist</option><option value="Max Assist">Max Assist</option><option value="Dependent">Dependent</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label for="ld_badl_dressing_level">Dressing:</label>
                            <select id="ld_badl_dressing_level" name="ld_badl_dressing_level">
                                <option value="">Select Level</option><option value="Independent">Independent</option><option value="Supervision">Supervision</option><option value="Mild Assist">Mild Assist</option><option value="Mod Assist">Mod Assist</option><option value="Max Assist">Max Assist</option><option value="Dependent">Dependent</option>
                            </select>
                        </div>
                        <div>
                            <label for="ld_badl_toileting_level">Toileting:</label>
                            <select id="ld_badl_toileting_level" name="ld_badl_toileting_level">
                                <option value="">Select Level</option><option value="Independent">Independent</option><option value="Supervision">Supervision</option><option value="Mild Assist">Mild Assist</option><option value="Mod Assist">Mod Assist</option><option value="Max Assist">Max Assist</option><option value="Dependent">Dependent</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label for="ld_badl_bathing_level">Bathing:</label>
                            <select id="ld_badl_bathing_level" name="ld_badl_bathing_level">
                                <option value="">Select Level</option><option value="Independent">Independent</option><option value="Supervision">Supervision</option><option value="Mild Assist">Mild Assist</option><option value="Mod Assist">Mod Assist</option><option value="Max Assist">Max Assist</option><option value="Dependent">Dependent</option>
                            </select>
                        </div>
                         <div> <!-- Placeholder for alignment --> </div>
                    </div>
                    <label for="ld_mbi_remarks">Remarks:</label>
                    <textarea id="ld_mbi_remarks" name="ld_mbi_remarks"></textarea>
            
                    <h4>IADL (SIB-R Short form)
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_iadl_sibr"> Exclude from Report</label></span>
                    </h4>
                    <div class="form-row">
                        <div>
                            <label>Patient's Chronological Age:</label>
                            <input type="number" name="ld_sibr_chron_age_year" placeholder="Year" style="width: 80px;"> year(s)
                            <input type="number" name="ld_sibr_chron_age_month" placeholder="Month" style="width: 80px;"> month(s)
                        </div>
                        <div>
                            <label>Broad Independence Age Equivalent:</label>
                            <input type="number" name="ld_sibr_indep_age_year" placeholder="Year" style="width: 80px;"> year(s)
                            <input type="number" name="ld_sibr_indep_age_month" placeholder="Month" style="width: 80px;"> month(s)
                        </div>
                    </div>
                    <label>Maladaptive Behaviour Severity Level:</label>
                    <div class="checkbox-group">
                        <label><input type="radio" name="ld_sibr_maladaptive_level" value="Normal">Normal</label>
                        <label><input type="radio" name="ld_sibr_maladaptive_level" value="Marginally serious">Marginally serious</label>
                        <label><input type="radio" name="ld_sibr_maladaptive_level" value="Moderately serious">Moderately serious</label>
                        <label><input type="radio" name="ld_sibr_maladaptive_level" value="Serious">Serious</label>
                        <label><input type="radio" name="ld_sibr_maladaptive_level" value="Very serious">Very serious</label>
                    </div>
                    <label>Support Score: <input type="text" name="ld_sibr_support_score"> /100</label>
                    <label>Support Level:</label>
                    <div class="checkbox-group">
                        <label><input type="radio" name="ld_sibr_support_level" value="Pervasive (1-24)">Pervasive (1-24)</label>
                        <label><input type="radio" name="ld_sibr_support_level" value="Extensive (25-39)">Extensive (25-39)</label>
                        <label><input type="radio" name="ld_sibr_support_level" value="Frequent (40-54)">Frequent (40-54)</label>
                        <label><input type="radio" name="ld_sibr_support_level" value="Limited (55-69)">Limited (55-69)</label>
                        <label><input type="radio" name="ld_sibr_support_level" value="Intermittent (70-84)">Intermittent (70-84)</label>
                        <label><input type="radio" name="ld_sibr_support_level" value="Infrequent or No support (85-100)">Infrequent or No support (85-100)</label>
                    </div>
                    <label for="ld_sibr_remarks">Remarks:</label>
                    <textarea id="ld_sibr_remarks" name="ld_sibr_remarks"></textarea>
                </fieldset>
            
                <fieldset>
                    <legend>7. Work Assessment
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_wa"> Exclude from Report</label></span>
                    </legend>
                    <h4>Premorbid
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_premorbid_work"> Exclude from Report</label></span>
                    </h4>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="ld_premorbid_status" value="Unemployed">Unemployed</label>
                        <label><input type="checkbox" name="ld_premorbid_status" value="Student">Student</label>
                        <label><input type="checkbox" name="ld_premorbid_status" value="DSC attendant">DSC attendant</label>
                        <label><input type="checkbox" name="ld_premorbid_status" value="DAC attendant">DAC attendant</label>
                        <label><input type="checkbox" name="ld_premorbid_status" value="SWS attendant">SWS attendant</label>
                        <label><input type="checkbox" name="ld_premorbid_status" value="SE attendant">SE attendant</label>
                    </div>
                    <div class="form-row">
                        <div style="display: flex; align-items: center; width: 100%;">
                            <label style="margin-right: 5px; width: auto;"><input type="checkbox" id="ld_premorbid_oe_job_status_cb" name="ld_premorbid_status" value="OE"> OE (job):</label>
                            <input type="text" id="ld_premorbid_oe_job_details" name="ld_premorbid_oe_job_details" placeholder="Specify OE job" style="flex-grow: 1; margin-bottom: 0;">
                        </div>
                    </div>
                    <label for="ld_premorbid_main_work_task">Main work task:</label>
                    <textarea id="ld_premorbid_main_work_task" name="ld_premorbid_main_work_task"></textarea>
            
                    <h4>BWAP-2
                        <span class="sub-section-exclude"><label><input type="checkbox" id="ld_exclude_bwap2"> Exclude from Report</label></span>
                    </h4>
                    <div class="grid-container">
                        <div>
                            <label>Work Habits/ Attitudes Percentile:</label> <input type="text" id="ld_bwap_wha_percentile" name="ld_bwap_wha_percentile">
                            <label>Working Placement:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_bwap_wha_placement" value="Day Care">Day Care</label>
                                <label><input type="checkbox" name="ld_bwap_wha_placement" value="Work Activity">Work Activity</label>
                                <label><input type="checkbox" name="ld_bwap_wha_placement" value="Low Sheltered">Low Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_wha_placement" value="High Sheltered">High Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_wha_placement" value="Transitional Work">Transitional Work</label>
                                <label><input type="checkbox" name="ld_bwap_wha_placement" value="Competitive Work">Competitive Work</label>
                            </div>
                        </div>
                        <div>
                            <label>Interpersonal Relations Percentile:</label> <input type="text" id="ld_bwap_ir_percentile" name="ld_bwap_ir_percentile">
                            <label>Working Placement:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_bwap_ir_placement" value="Day Care">Day Care</label>
                                <label><input type="checkbox" name="ld_bwap_ir_placement" value="Work Activity">Work Activity</label>
                                <label><input type="checkbox" name="ld_bwap_ir_placement" value="Low Sheltered">Low Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_ir_placement" value="High Sheltered">High Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_ir_placement" value="Transitional Work">Transitional Work</label>
                                <label><input type="checkbox" name="ld_bwap_ir_placement" value="Competitive Work">Competitive Work</label>
                            </div>
                        </div>
                        <div>
                            <label>Cognitive Skills Percentile:</label> <input type="text" id="ld_bwap_cs_percentile" name="ld_bwap_cs_percentile">
                            <label>Working Placement:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_bwap_cs_placement" value="Day Care">Day Care</label>
                                <label><input type="checkbox" name="ld_bwap_cs_placement" value="Work Activity">Work Activity</label>
                                <label><input type="checkbox" name="ld_bwap_cs_placement" value="Low Sheltered">Low Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_cs_placement" value="High Sheltered">High Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_cs_placement" value="Transitional Work">Transitional Work</label>
                                <label><input type="checkbox" name="ld_bwap_cs_placement" value="Competitive Work">Competitive Work</label>
                            </div>
                        </div>
                        <div>
                            <label>Work Performance Skills Percentile:</label> <input type="text" id="ld_bwap_wps_percentile" name="ld_bwap_wps_percentile">
                            <label>Working Placement:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_bwap_wps_placement" value="Day Care">Day Care</label>
                                <label><input type="checkbox" name="ld_bwap_wps_placement" value="Work Activity">Work Activity</label>
                                <label><input type="checkbox" name="ld_bwap_wps_placement" value="Low Sheltered">Low Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_wps_placement" value="High Sheltered">High Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_wps_placement" value="Transitional Work">Transitional Work</label>
                                <label><input type="checkbox" name="ld_bwap_wps_placement" value="Competitive Work">Competitive Work</label>
                            </div>
                        </div>
                        <div>
                            <label>Broad Work Adjustment Percentile:</label> <input type="text" id="ld_bwap_bwa_percentile" name="ld_bwap_bwa_percentile">
                            <label>Working Placement:</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ld_bwap_bwa_placement" value="Day Care">Day Care</label>
                                <label><input type="checkbox" name="ld_bwap_bwa_placement" value="Work Activity">Work Activity</label>
                                <label><input type="checkbox" name="ld_bwap_bwa_placement" value="Low Sheltered">Low Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_bwa_placement" value="High Sheltered">High Sheltered</label>
                                <label><input type="checkbox" name="ld_bwap_bwa_placement" value="Transitional Work">Transitional Work</label>
                                <label><input type="checkbox" name="ld_bwap_bwa_placement" value="Competitive Work">Competitive Work</label>
                            </div>
                        </div>
                    </div>
                    <label for="ld_bwap_remarks">Remarks:</label>
                    <textarea id="ld_bwap_remarks" name="ld_bwap_remarks"></textarea>
                </fieldset>
                
                <fieldset>
                    <legend>OT Plan Options
                        <span class="section-exclude"><label><input type="checkbox" id="ld_exclude_otp"> Exclude from Report</label></span>
                    </legend>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="ld_otp_mental_state" name="ld_otp_item" value="Mental state observation">Mental state observation</label><br>
                        <label><input type="checkbox" id="ld_otp_hand_function" name="ld_otp_item" value="Hand function training">Hand function training</label><br>
                        <label><input type="checkbox" id="ld_otp_sensory_intervention" name="ld_otp_item" value="Sensory-based intervention">Sensory-based intervention</label><br>
                        <label><input type="checkbox" id="ld_otp_behavioural_management" name="ld_otp_item" value="Behavioural management">Behavioural management</label><br>
                        <label><input type="checkbox" id="ld_otp_home_visit" name="ld_otp_item" value="Home / Hostel visit">Home / Hostel visit on (date)</label><br>
                        <label><input type="checkbox" id="ld_otp_adl_iadl_training" name="ld_otp_item" value="ADL / IADL functional training">ADL / IADL functional training</label><br>
                        <label><input type="checkbox" id="ld_otp_sws_dac_training" name="ld_otp_item" value="SWS / DAC simulation training">SWS / DAC simulation training</label><br>
                        <label><input type="checkbox" id="ld_otp_aids_garment" name="ld_otp_item" value="Aids/ Special garment: (name) prescription">Aids/ Special garment: (name) prescription</label>
                    </div>
                    <label for="ld_ot_plan_custom">Custom OT Plan items (add each on a new line):</label>
                    <textarea id="ld_ot_plan_custom" name="ld_ot_plan_custom"></textarea>
                </fieldset>
            
                <button type="button" id="generateLDReportBtn" onclick="generateLDReport()">Generate Report</button>
            
                <div class="report-output">
                    <h3>Generated LD Report</h3>
                    <textarea id="ldReportTextArea" readonly></textarea> 
                    <button type="button" id="copyLDReportBtn" onclick="copyLDReport()">Copy Report</button>
                    <span id="ldCopyMessage"></span> 
                </div>
            </form>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- Common Navigation Elements ---
        const progressLDBtn = document.getElementById('progressLDBtn');
        const dcAdultBtn = document.getElementById('dcAdultBtn');
        // Add other nav buttons here if they become active later

        const adultDcSummaryContainer = document.getElementById('adultDcSummaryContainer');
        const ldAssessmentContainer = document.getElementById('ldAssessmentContainer');
        const allFormSections = document.querySelectorAll('.form-section');
        const allNavButtons = document.querySelectorAll('.navigation-area button');
        
        let currentActiveFormId = null; // To track the currently displayed form

        // --- Form Switching Logic ---
        function setActiveForm(formContainerIdToShow, clickedButtonEl) {
            // 1. Handle button active states
            allNavButtons.forEach(btn => btn.classList.remove('active')); 
            if (clickedButtonEl) {
                clickedButtonEl.classList.add('active'); 
            }

            // 2. Clear data if switching to a different form
            if (currentActiveFormId && currentActiveFormId !== formContainerIdToShow) {
                if (currentActiveFormId === 'adultDcSummaryContainer' && adultResetFormBtn) {
                    console.log("Resetting Adult DC Summary Form as it is being switched away from.");
                    adultResetFormBtn.click(); 
                } else if (currentActiveFormId === 'ldAssessmentContainer') {
                    console.log("Resetting LD Assessment Form as it is being switched away from.");
                    resetLDForm(); 
                }
            }

            // 3. Show the new form
            allFormSections.forEach(section => {
                section.style.display = 'none';
                section.classList.remove('active');
            });

            const sectionToShow = document.getElementById(formContainerIdToShow);
            if (sectionToShow) {
                sectionToShow.style.display = 'block';
                sectionToShow.classList.add('active');
            }

            // 4. Update current active form and initialize
            currentActiveFormId = formContainerIdToShow;
            if (formContainerIdToShow === 'adultDcSummaryContainer') {
                initializeAdultDcForm();
            } else if (formContainerIdToShow === 'ldAssessmentContainer') {
                initializeLdAssessmentForm();
            }
        }

        if(progressLDBtn) progressLDBtn.addEventListener('click', () => setActiveForm('ldAssessmentContainer', progressLDBtn));
        if(dcAdultBtn) dcAdultBtn.addEventListener('click', () => setActiveForm('adultDcSummaryContainer', dcAdultBtn));


        // --- Adult DC Summary Form Specific Logic ---
        const adultForm = document.getElementById('adultForm');
        const adultGenerateReportBtn = document.getElementById('generateReportBtn'); 
        const adultCopyReportBtn = document.getElementById('copyReportBtn'); 
        const adultResetFormBtn = document.getElementById('resetFormBtn'); 
        const adultGeneratedReportTextarea = document.getElementById('generatedReport');
        
        const adultWorkOverallNilRadio = adultForm ? adultForm.querySelector('#workNilRadioOverall') : null;
        const adultWorkVOptionsList_js = ["V2", "V3", "V6", "V7", "V8", "V9", "V19"];

        const adultThoughtCheckboxes = adultForm ? adultForm.querySelectorAll('input[name="thought"]') : null;
        const adultThoughtOtherCheckbox = adultForm ? adultForm.querySelector('#thoughtOtherChk') : null;
        const adultThoughtOtherTextbox = adultForm ? adultForm.querySelector('#thoughtOtherText') : null;
        const adultThoughtNilCheckbox = adultForm ? adultForm.querySelector('#thoughtNilChk') : null;

        function initializeAdultDcForm() {
            if (!adultForm) return; 
            const workItemsContainer = adultForm.querySelector('#workItemsContainer');
            if (workItemsContainer && !workItemsContainer.innerHTML.trim()) { // Only generate if empty
                const adult_workVOptions_render = ["V2", "V3", "V6", "V7", "V8", "V9", "V19"];
                const adult_workRatings_render = ["MME", "M", "DNMA", "DNMB"];
                let adult_workHtml_render = '';
                adult_workVOptions_render.forEach(v => {
                    adult_workHtml_render += `
                    <div class="work-v-item" data-v-id="${v}">
                        <div class="work-v-label-container">
                            <input type="checkbox" name="workV_selected_${v}" value="${v}" id="adult_workV_selected_${v}">
                            <span>${v} WQP:</span>
                        </div>
                        <div class="radio-group work-v-rating">`;
                    adult_workRatings_render.forEach(r => {
                        adult_workHtml_render += `<label><input type="radio" name="adult_workV_rating_${v}" value="${r}" disabled> ${r}</label>`;
                    });
                    adult_workHtml_render += `</div></div>`;
                });
                workItemsContainer.innerHTML = adult_workHtml_render;
            }


            if (adultThoughtNilCheckbox) { 
                adultThoughtNilCheckbox.removeEventListener('change', adultHandleThoughtExclusiveChecks); 
                adultThoughtNilCheckbox.addEventListener('change', adultHandleThoughtExclusiveChecks);
            }
            if(adultThoughtCheckboxes) {
                adultThoughtCheckboxes.forEach(cb => {
                    cb.removeEventListener('change', adultThoughtCheckboxChangeHandler);
                    cb.addEventListener('change', adultThoughtCheckboxChangeHandler);
                });
            }
            if (adultThoughtOtherCheckbox) {
                adultThoughtOtherCheckbox.removeEventListener('change', adultThoughtOtherCheckboxChangeHandler);
                adultThoughtOtherCheckbox.addEventListener('change', adultThoughtOtherCheckboxChangeHandler);
            }
            if(adultThoughtNilCheckbox) adultHandleThoughtExclusiveChecks(); 

            adultWorkVOptionsList_js.forEach(vId => {
                const vCheckbox = adultForm.querySelector(`#adult_workV_selected_${vId}`); 
                if (vCheckbox) {
                    vCheckbox.removeEventListener('change', adultWorkVCheckboxChangeHandler); 
                    vCheckbox.addEventListener('change', adultWorkVCheckboxChangeHandler);
                    const ratingRadios = adultForm.querySelectorAll(`input[name="adult_workV_rating_${vId}"]`);
                    ratingRadios.forEach(radio => {
                        radio.disabled = !vCheckbox.checked;
                        if (!vCheckbox.checked) radio.checked = false;
                    });
                }
            });
            if (adultWorkOverallNilRadio) {
                adultWorkOverallNilRadio.removeEventListener('change', adultWorkOverallNilChangeHandler);
                adultWorkOverallNilRadio.addEventListener('change', adultWorkOverallNilChangeHandler);
                adultUpdateOverallNilEffect(adultWorkOverallNilRadio.checked); 
            }
        }
        
        function adultWorkVCheckboxChangeHandler() { 
            const vId = this.value;
            const ratingRadios = adultForm.querySelectorAll(`input[name="adult_workV_rating_${vId}"]`);
            ratingRadios.forEach(radio => {
                radio.disabled = !this.checked;
                if (!this.checked) radio.checked = false;
            });
            if (this.checked && adultWorkOverallNilRadio) {
                adultWorkOverallNilRadio.checked = false;
                adultUpdateOverallNilEffect(false);
            }
        }

        function adultWorkOverallNilChangeHandler() { 
             adultUpdateOverallNilEffect(this.checked);
        }
        
        function adultHandleThoughtExclusiveChecks() {
            if (!adultThoughtNilCheckbox || !adultThoughtOtherCheckbox || !adultThoughtOtherTextbox || !adultThoughtCheckboxes) return;
            const isNilChecked = adultThoughtNilCheckbox.checked;
            const isOtherChecked = adultThoughtOtherCheckbox.checked;

            adultThoughtCheckboxes.forEach(cb => { 
                cb.disabled = isNilChecked; 
                if(isNilChecked) cb.checked = false; 
            });

            adultThoughtOtherCheckbox.disabled = isNilChecked;
            if(isNilChecked) adultThoughtOtherCheckbox.checked = false;
            
            const enableAndDisplayOtherText = isOtherChecked && !isNilChecked;
            adultThoughtOtherTextbox.disabled = !enableAndDisplayOtherText;
            adultThoughtOtherTextbox.style.display = enableAndDisplayOtherText ? 'block' : 'none';
            if(!enableAndDisplayOtherText) adultThoughtOtherTextbox.value = '';
        }

        function adultThoughtCheckboxChangeHandler() { 
            if (this.checked && adultThoughtNilCheckbox) {
                adultThoughtNilCheckbox.checked = false;
                adultHandleThoughtExclusiveChecks(); 
            }
        }
        function adultThoughtOtherCheckboxChangeHandler() { 
            if (this.checked && adultThoughtNilCheckbox) {
                adultThoughtNilCheckbox.checked = false;
            }
            adultHandleThoughtExclusiveChecks(); 
        }

        function adultUpdateOverallNilEffect(isNilChecked) {
            if (!adultForm) return;
             adultWorkVOptionsList_js.forEach(vId => {
                const vCheckbox = adultForm.querySelector(`#adult_workV_selected_${vId}`);
                const ratingRadios = adultForm.querySelectorAll(`input[name="adult_workV_rating_${vId}"]`);
                if (vCheckbox) vCheckbox.disabled = isNilChecked;
                ratingRadios.forEach(radio => {
                    radio.disabled = isNilChecked || (vCheckbox && !vCheckbox.checked);
                    if (isNilChecked) {
                       if(vCheckbox) vCheckbox.checked = false;
                       radio.checked = false;
                    }
                });
            });
        }

        function getAdultCheckboxValues(name) {
            if (!adultForm) return '';
            const checkboxes = adultForm.querySelectorAll(`input[name="${name}"]:checked`);
            const values = Array.from(checkboxes).map(cb => cb.value);
            return values.length > 0 ? values.join(' / ') : '';
        }
        function getAdultRadioValue(name) {
            if (!adultForm) return '';
            const radio = adultForm.querySelector(`input[name="${name}"]:checked`);
            return radio ? radio.value : '';
        }
        function getAdultTextValue(idOrName, isName = false) {
            if (!adultForm) return '';
            const element = isName ? adultForm.querySelector(`[name="${idOrName}"]`) : adultForm.querySelector(`#${idOrName}`);
            return element ? element.value.trim() : '';
        }
        function getAdultCognitiveTestValue() {
            if (!adultForm) return '';
            const selectedTestRadio = adultForm.querySelector('input[name="cognitiveTest"]:checked');
            if (!selectedTestRadio || selectedTestRadio.value === "Nil") return selectedTestRadio ? "Nil" : ""; 
            const testName = selectedTestRadio.value;
            let scoreInputName, suffix;
            switch(testName) {
                case "HK-MoCA": scoreInputName = "cognitiveScore_hkMoca"; suffix = "/30"; break;
                case "Hk-MoCA 5": scoreInputName = "cognitiveScore_hkMoca5"; suffix = "/30"; break;
                case "AMT": scoreInputName = "cognitiveScore_amt"; suffix = "/10"; break;
                case "CFAB": scoreInputName = "cognitiveScore_cfab"; suffix = "/18"; break;
                case "HKBC": scoreInputName = "cognitiveScore_hkbc"; suffix = "/30"; break;
                default: return ""; 
            }
            const score = adultForm.querySelector(`input[name="${scoreInputName}"]`).value.trim();
            return score ? `${testName} ${score}${suffix}` : `${testName} (score not entered)`;
        }
        function addAdultReportLine(currentReport, label, value, isMultiPartValue = false, multiPartSeparator = " / ") {
            if (isMultiPartValue) {
                const validParts = Array.isArray(value) ? value.filter(part => part && part.toString().trim() !== '') : [];
                if (validParts.length > 0) {
                    return currentReport + `${label}: ${validParts.join(multiPartSeparator)}\n`;
                }
            } else if (value && value.toString().trim() !== '') {
                return currentReport + `${label}: ${value.toString().trim()}\n`;
            }
            return currentReport;
        }

        if (adultGenerateReportBtn) {
            adultGenerateReportBtn.addEventListener('click', function () {
                // ... (Adult report generation logic - kept as is) ...
                let report = "Psy Documentation (Adult DC Sum)\n";
                report += "==================================\n\n";
                report += "1. Mental State & Insight\n\n";
                report = addAdultReportLine(report, "Overall impression", getAdultRadioValue('overallImpression'));
                report = addAdultReportLine(report, "Mood", getAdultRadioValue('mood'));
                report = addAdultReportLine(report, "Affect", getAdultRadioValue('affect'));
                report = addAdultReportLine(report, "Speech", getAdultCheckboxValues('speech'));
                report = addAdultReportLine(report, "Hallucination", getAdultCheckboxValues('hallucination'));
                let thoughtReportVal = "";
                if (adultThoughtNilCheckbox && adultThoughtNilCheckbox.checked) {
                    thoughtReportVal = "Nil";
                } else {
                    let thoughtParts = [];
                    const specificThoughts = getAdultCheckboxValues('thought');
                    if (specificThoughts) {
                        thoughtParts = specificThoughts.split(' / ').filter(t => t.trim() !== '');
                    }
                    if (adultThoughtOtherCheckbox && adultThoughtOtherCheckbox.checked) {
                        const otherText = getAdultTextValue('thoughtOtherText');
                        thoughtParts.push(otherText ? `Other: ${otherText}` : `Other (not specified)`);
                    }
                    if (thoughtParts.length > 0) {
                        thoughtReportVal = thoughtParts.join(' / ');
                    }
                }
                report = addAdultReportLine(report, "Thought", thoughtReportVal);
                report = addAdultReportLine(report, "Behavior", getAdultCheckboxValues('behavior'));
                report = addAdultReportLine(report, "Cognitive", getAdultCheckboxValues('cognitiveState'));
                report = addAdultReportLine(report, "Risk", getAdultCheckboxValues('risk'));
                report = addAdultReportLine(report, "Insight", getAdultRadioValue('insight'));
                report = addAdultReportLine(report, "Remarks", getAdultTextValue('remarksMentalState'));
                report += "\n";
                report += "2. Assessment Results\n\n";
                let workReportContent = "";
                if (adultWorkOverallNilRadio && adultWorkOverallNilRadio.checked) {
                    workReportContent = "Nil";
                } else {
                    let workReportPartsList = [];
                    adultWorkVOptionsList_js.forEach(vId => {
                        const vCheckbox = adultForm.querySelector(`#adult_workV_selected_${vId}`);
                        if (vCheckbox && vCheckbox.checked) {
                            const ratingValue = getAdultRadioValue(`adult_workV_rating_${vId}`);
                            workReportPartsList.push(`${vId} WQP (${ratingValue || 'Rating N/S'})`);
                        }
                    });
                    if (workReportPartsList.length > 0) {
                        workReportContent = workReportPartsList.join(' / ');
                    }
                }
                report = addAdultReportLine(report, "Work", workReportContent);
                report = addAdultReportLine(report, "Recommended work level", getAdultRadioValue('recommendedWorkLevel'));
                let adlParts = [];
                const adlRadioVal = getAdultRadioValue('adl');
                const adlMbiScoreVal = getAdultTextValue('adlMbiScore');
                if (adlRadioVal) adlParts.push(adlRadioVal);
                if (adlMbiScoreVal) adlParts.push(`MBI: ${adlMbiScoreVal}/100`);
                report = addAdultReportLine(report, "ADL", adlParts, true);
                let iadlParts = [];
                const iadlCfnaVal = getAdultRadioValue('iadlCfna');
                const iadlCfnaScoreVal = getAdultTextValue('iadlCfnaScore');
                if (iadlCfnaVal) iadlParts.push(iadlCfnaVal);
                if (iadlCfnaScoreVal) iadlParts.push(`CFNA: ${iadlCfnaScoreVal}/650`);
                report = addAdultReportLine(report, "IADL", iadlParts, true);
                report = addAdultReportLine(report, "Domestic", getAdultCheckboxValues('domestic'));
                report = addAdultReportLine(report, "Childcare", getAdultRadioValue('childcare'));
                report = addAdultReportLine(report, "Cognitive", getAdultCognitiveTestValue());
                report = addAdultReportLine(report, "Overall performance", getAdultRadioValue('overallPerformance'));
                report = addAdultReportLine(report, "Daily functioning", getAdultRadioValue('dailyFunctioning'));
                report += "\n";
                report += "3. Interventions Provided\n\n";
                report = addAdultReportLine(report, "Work rehabilitation", getAdultCheckboxValues('interventionWork'));
                report = addAdultReportLine(report, "Self-management Training", getAdultCheckboxValues('interventionSelfMgmt'));
                report = addAdultReportLine(report, "Interpersonal Skills Training", getAdultCheckboxValues('interventionInterpersonal'));
                report = addAdultReportLine(report, "Cognitive Training", getAdultCheckboxValues('interventionCognitive'));
                report = addAdultReportLine(report, "Life Coaching", getAdultCheckboxValues('interventionLifeCoaching'));
                report = addAdultReportLine(report, "Behavioral Management Training", getAdultCheckboxValues('interventionBehavioral'));
                report = addAdultReportLine(report, "Home Assessment & Modification", getAdultCheckboxValues('interventionHome'));
                report = addAdultReportLine(report, "Sensory Based Intervention", getAdultCheckboxValues('interventionSensory'));
                report = addAdultReportLine(report, "Physical Training", getAdultCheckboxValues('interventionPhysical'));
                report = addAdultReportLine(report, "Aids Prescription and Training", getAdultCheckboxValues('interventionAids'));
                report = addAdultReportLine(report, "Caregiver Training on", getAdultTextValue('interventionCaregiverTraining'));
                report = addAdultReportLine(report, "Others, please specify", getAdultTextValue('interventionOthers'));
                report += "\n";
                report += "4. Discharged Plan and Recommendations\n\n";
                report = addAdultReportLine(report, "Residential", getAdultRadioValue('dischargeResidential'));
                report = addAdultReportLine(report, "Recommendation", getAdultTextValue('dischargeResidentialReco'));
                let vocationalParts = [];
                const vocationalOptionsVal = getAdultCheckboxValues('dischargeVocational');
                const vocationalReferredOnVal = getAdultTextValue('dischargeVocationalReferredOn');
                if (vocationalOptionsVal) vocationalParts.push(vocationalOptionsVal);
                if (vocationalReferredOnVal) vocationalParts.push(`Referred on: ${vocationalReferredOnVal}`);
                report = addAdultReportLine(report, "Vocational", vocationalParts, true);
                report = addAdultReportLine(report, "Recommendation", getAdultTextValue('dischargeVocationalReco'));
                let daytimeParts = [];
                const daytimeOptionsVal = getAdultCheckboxValues('dischargeDaytime');
                const daytimeReferredOnVal = getAdultTextValue('dischargeDaytimeReferredOn');
                if (daytimeOptionsVal) daytimeParts.push(daytimeOptionsVal);
                if (daytimeReferredOnVal) daytimeParts.push(`Referred on: ${daytimeReferredOnVal}`);
                report = addAdultReportLine(report, "Daytime engagement", daytimeParts, true);
                report = addAdultReportLine(report, "Recommendation", getAdultTextValue('dischargeDaytimeReco'));
                report = addAdultReportLine(report, "Others (PCP related)", getAdultCheckboxValues('dischargeOthersPCP'));
                report = addAdultReportLine(report, "Other recommendations", getAdultCheckboxValues('dischargeOthersReco'));
                report = addAdultReportLine(report, "Others (discharge plan specify)", getAdultTextValue('dischargePlanOthersSpecify'));
                if(adultGeneratedReportTextarea) adultGeneratedReportTextarea.value = report.trim(); 
            });
        }
        if (adultCopyReportBtn) {
            adultCopyReportBtn.addEventListener('click', function () {
                if (adultGeneratedReportTextarea && adultGeneratedReportTextarea.value) {
                    navigator.clipboard.writeText(adultGeneratedReportTextarea.value)
                        .then(() => { alert('Adult DC Summary copied to clipboard!'); })
                        .catch(err => {
                            console.error('Failed to copy report: ', err);
                            try {
                                adultGeneratedReportTextarea.select();
                                document.execCommand('copy');
                                alert('Adult DC Summary copied (fallback method)!');
                            } catch (e) {
                                alert('Failed to copy. Please copy manually.');
                            }
                        });
                } else {
                    alert('No Adult DC Summary generated to copy.');
                }
            });
        }
        if (adultResetFormBtn) {
            adultResetFormBtn.addEventListener('click', function() {
                if (adultForm) adultForm.reset(); 
                if (adultGeneratedReportTextarea) adultGeneratedReportTextarea.value = ''; 
                
                // Re-initialize UI states that form.reset() might not fully cover for adult form
                if (adultWorkOverallNilRadio) adultUpdateOverallNilEffect(adultWorkOverallNilRadio.checked); 
                adultWorkVOptionsList_js.forEach(vId => { 
                    const vCheckbox = adultForm.querySelector(`#adult_workV_selected_${vId}`); 
                    const ratingRadios = adultForm.querySelectorAll(`input[name="adult_workV_rating_${vId}"]`);
                    if(vCheckbox && ratingRadios) { // Check elements exist
                        ratingRadios.forEach(radio => {
                            radio.disabled = !vCheckbox.checked; // Correctly disable if parent is unchecked
                            radio.checked = false; 
                        });
                    }
                });
                if (adultThoughtNilCheckbox) { 
                     adultHandleThoughtExclusiveChecks(); 
                }
                 alert('Adult DC Summary Form has been reset.');
            });
        }


        // --- LD Assessment Form Specific Logic ---
        const ldForm = document.getElementById('ldForm'); 
        const ldReportTextArea = ldForm ? ldForm.querySelector('#ldReportTextArea') : null;
        const ldCopyMessage = ldForm ? ldForm.querySelector('#ldCopyMessage') : null;

        function initializeLdAssessmentForm() {
            if (!ldForm) return; 
            const ldRestrainPolicyRadios = ldForm.querySelectorAll('input[name="ld_restrain_policy"]');
            ldRestrainPolicyRadios.forEach(radio => {
                radio.removeEventListener('change', ldHandleRestrainPolicyChange); 
                radio.addEventListener('change', ldHandleRestrainPolicyChange);
                if (radio.checked) ldHandleRestrainPolicyChange.call(radio); 
            });

            const ldMbiScoreFields = ldForm.querySelectorAll('.ld-mbi-score-field');
            ldMbiScoreFields.forEach(field => {
                field.removeEventListener('input', ldUpdateMbiTotal);
                field.addEventListener('input', ldUpdateMbiTotal);
            });
            ldUpdateMbiTotal(); 

            const ldMasTotalScoreInputs = ldForm.querySelectorAll('.ld-mas-total-score');
            ldMasTotalScoreInputs.forEach(input => {
                input.removeEventListener('input', ldMasTotalScoreChangeHandler);
                input.addEventListener('input', ldMasTotalScoreChangeHandler);
                if (input.value) ldMasTotalScoreChangeHandler.call(input);
            });
            ldUpdateMasRankings(); 
        }

        function ldHandleRestrainPolicyChange() { 
            const detailsSection = ldForm.querySelector('#ld_restrain_details_section');
            if (detailsSection) {
                detailsSection.style.display = this.value === 'Yes' ? 'block' : 'none';
            }
        }
        
        function ldMasTotalScoreChangeHandler() { 
            const functionKey = this.id.split('_')[2]; 
            const total = parseFloat(this.value);
            const averageField = ldForm.querySelector(`#ld_mas_${functionKey}_average`);
            if (averageField) {
                if (!isNaN(total)) {
                    averageField.value = (total / 4).toFixed(2); 
                } else {
                    averageField.value = ''; 
                }
            }
            ldUpdateMasRankings();
        }

        function ldUpdateMbiTotal() {
            if (!ldForm) return;
            let total = 0;
            const ldMbiScoreFields = ldForm.querySelectorAll('.ld-mbi-score-field');
            ldMbiScoreFields.forEach(field => {
                const val = parseInt(field.value) || 0;
                total += val;
            });
            const totalDisplay = ldForm.querySelector('#ld_mbi_total_score_display');
            if (totalDisplay) totalDisplay.value = total;
        }
        
        function ldUpdateMasRankings() {
            if (!ldForm) return;
            const functions = ['sensory', 'escape', 'attention', 'tangible'];
            let scoresData = functions.map(func => {
                const totalVal = getLDVal(`ld_mas_${func}_total`);
                return {
                    name: func,
                    total: (totalVal !== '' && !isNaN(parseFloat(totalVal))) ? parseFloat(totalVal) : -Infinity, 
                    rankInputId: `ld_mas_${func}_ranking`
                };
            });

            let rankedScores = scoresData.filter(s => s.total !== -Infinity);
            rankedScores.sort((a, b) => b.total - a.total);

            let currentRank = 0; 
            let lastScore = null;
            for (let i = 0; i < rankedScores.length; i++) {
                if (lastScore === null || rankedScores[i].total < lastScore) {
                    currentRank++; 
                }
                const rankInput = ldForm.querySelector(`#${rankedScores[i].rankInputId}`);
                if (rankInput) rankInput.value = currentRank;
                lastScore = rankedScores[i].total;
            }

            scoresData.forEach(s => {
                if (s.total === -Infinity) {
                    const rankInput = ldForm.querySelector(`#${s.rankInputId}`);
                    if (rankInput) rankInput.value = '';
                }
            });
        }

        function getLDVal(id) {
            if (!ldForm) return '';
            const el = ldForm.querySelector(`#${id}`);
            return el ? el.value : '';
        }
        function isLDChecked(id) {
            if (!ldForm) return false;
            const el = ldForm.querySelector(`#${id}`);
            return el ? el.checked : false;
        }
        function getLDCheckedValues(name) {
            if (!ldForm) return [];
            const checkboxes = ldForm.querySelectorAll(`input[name="${name}"]:checked`);
            return Array.from(checkboxes).map(cb => cb.value);
        }
        function getLDRadioValue(name) {
            if (!ldForm) return '';
            const radio = ldForm.querySelector(`input[name="${name}"]:checked`);
            return radio ? radio.value : '';
        }
        
        function resetLDForm() {
            if (ldForm) {
                ldForm.reset(); 
            }
            if (ldReportTextArea) {
                ldReportTextArea.value = ''; 
            }
            initializeLdAssessmentForm(); // Re-run initialization to set default UI states
            console.log("LD Form has been reset.");
        }


        window.generateLDReport = function() {
            // ... (LD report generation logic - kept as is, using getLDVal, isLDChecked etc.) ...
            if (!ldForm) return; 
            let report = "LD Assessment Documentation:\n\n";
            const assessmentDate = getLDVal('ld_assessmentDate');
            report += `Assessment Date: ${assessmentDate || 'Not Specified'}\n\n`;

            const formatCheckboxList = (items) => items.length > 0 ? items.join(' / ') : 'N/A'; 
            const formatLine = (label, value) => value && value.trim() !== '' && value !== 'N/A' ? `${label}: ${value}\n` : '';
            const formatMultiLine = (label, value) => value && value.trim() !== '' ? `${label}:\n${value.split('\n').map(l => `  ${l}`).join('\n')}\n` : '';


            if (!isLDChecked('ld_exclude_mse')) {
                report += "Mental State Examination\n";
                report += "--------------------------\n";
                let comorbidityItems = getLDCheckedValues('ld_comorbidity');
                let comorbidityOthers = getLDVal('ld_comorbidity_others');
                if (comorbidityOthers) comorbidityItems.push(`Others - ${comorbidityOthers}`);
                report += formatLine("Comorbidity", formatCheckboxList(comorbidityItems));

                let moodItems = getLDCheckedValues('ld_mood');
                let moodOthers = getLDVal('ld_mood_others');
                if (moodOthers) moodItems.push(`Others - ${moodOthers}`);
                report += formatLine("Mood", formatCheckboxList(moodItems));
                report += formatLine("Affect", formatCheckboxList(getLDCheckedValues('ld_affect')));
                
                let receptiveSteps = getLDVal('ld_receptive_steps');
                let receptiveCommandType = getLDVal('ld_receptive_command_type');
                let receptiveOptions = getLDCheckedValues('ld_receptive_speech_options');
                let receptiveSpeechReport = "";
                if (receptiveSteps && receptiveCommandType) {
                    receptiveSpeechReport += `Follow ${receptiveSteps} step ${receptiveCommandType} command. `;
                }
                if (receptiveOptions.length > 0) {
                    receptiveSpeechReport += receptiveOptions.join(', ') + ".";
                }
                if (receptiveSpeechReport.trim() === "") receptiveSpeechReport = "N/A";
                report += formatLine("Receptive Speech", receptiveSpeechReport.trim());
                report += formatLine("Expressive Speech", formatCheckboxList(getLDCheckedValues('ld_expressive_speech')));

                if (isLDChecked('ld_hallucination_nil')) {
                    report += "Hallucination: Nil\n";
                } else {
                    report += formatLine("Hallucination", formatCheckboxList(getLDCheckedValues('ld_hallucination')));
                }
                if (isLDChecked('ld_abnormal_thought_nil')) {
                    report += "Abnormal Thought: Nil\n";
                } else {
                    let abnormalThoughtItems = getLDCheckedValues('ld_abnormal_thought');
                    let abnormalThoughtOthers = getLDVal('ld_abnormal_thought_others');
                    if (abnormalThoughtOthers) abnormalThoughtItems.push(`Other - ${abnormalThoughtOthers}`);
                    report += formatLine("Abnormal Thought", formatCheckboxList(abnormalThoughtItems));
                }
                let behaviourItems = getLDCheckedValues('ld_behaviour');
                let behaviourOthers = getLDVal('ld_behaviour_others');
                if (behaviourOthers) behaviourItems.push(`Others - ${behaviourOthers}`);
                report += formatLine("Behaviour", formatCheckboxList(behaviourItems));
                report += formatLine("Cognitive", formatCheckboxList(getLDCheckedValues('ld_cognitive')));
                if (isLDChecked('ld_risk_nil')) {
                    report += "Risk: Nil\n";
                } else {
                    report += formatLine("Risk", formatCheckboxList(getLDCheckedValues('ld_risk')));
                }
                report += formatLine("Insight", formatCheckboxList(getLDCheckedValues('ld_insight')));
                report += formatMultiLine("MSE Others/Remarks", getLDVal('ld_mse_others_remarks'));
                report += "\n";
            }

            if (!isLDChecked('ld_exclude_pa')) {
                report += "Physical Assessment\n";
                report += "--------------------\n";
                if (getLDRadioValue('ld_wound_present') === 'Y') {
                    let woundTypes = getLDCheckedValues('ld_wound_type').join(', ');
                    if (getLDVal('ld_wound_type_others')) woundTypes += (woundTypes ? ', ' : '') + `Others: ${getLDVal('ld_wound_type_others')}`;
                    let woundDressing = getLDRadioValue('ld_wound_dressing') === 'Yes' ? 'on dressing' : 'no dressing';
                    report += `Wound: ${woundTypes || 'Type not specified'} at ${getLDVal('ld_wound_location') || 'location not specified'}, ${woundDressing}.\n`;
                } else {
                    report += "Wound: No\n";
                }
                report += formatMultiLine("General Other observation", getLDVal('ld_general_other_observation'));

                report += "\nRange & Contracture/Deformity:\n";
                const limbs = ['rul', 'lul', 'rll', 'lll'];
                limbs.forEach(limb => {
                    const aromVal = getLDVal(`ld_${limb}_arom`);
                    const functional = isLDChecked(`ld_${limb}_arom_functional`);
                    let aromText = "N/A"; 
                    if (functional) aromText = "Functional";
                    else if (aromVal && aromVal.trim() !== '') aromText = aromVal;
                    
                    const promVal = getLDVal(`ld_${limb}_prom`) || "N/A";
                    const contractureVal = getLDRadioValue(`ld_${limb}_contracture`) === 'Y' ? 'Yes' : 'No';
                    report += `  ${limb.toUpperCase()}: AROM: ${aromText}, PROM: ${promVal}, Contracture/Deformity: ${contractureVal}\n`;
                });
                const contractureDetails = getLDVal('ld_pa_contracture_details');
                if (contractureDetails) report += `  Contracture/Deformity details: ${contractureDetails}\n`;
                
                report += "\nStrength (MMT):\n";
                report += `  RUL: ${getLDVal('ld_rul_mmt') || 'N/A'}, LUL: ${getLDVal('ld_lul_mmt') || 'N/A'}\n`;
                report += `  RLL: ${getLDVal('ld_rll_mmt') || 'N/A'}, LLL: ${getLDVal('ld_lll_mmt') || 'N/A'}\n`;

                report += "\nFine Motor:\n";
                const fmCats = ['grasp', 'opposition', 'pinch_grip', 'hand_writing'];
                ['rul', 'lul'].forEach(limb => {
                    let fmItems = fmCats.map(cat => `${cat.replace('_',' ')} (${isLDChecked(`ld_${limb}_${cat}`) ? '√' : 'X'})`);
                    report += `  ${limb.toUpperCase()}: ${fmItems.join(', ')}\n`;
                });
                report += "\n";
            }

            if (!isLDChecked('ld_exclude_sa')) {
                report += "Sensory Assessment\n";
                report += "-------------------\n";
                let sensoryDesc = [];
                const senses = ['auditory', 'visual', 'oral', 'tactile', 'proprioception', 'vestibular'];
                senses.forEach(sense => {
                    if (getLDCheckedValues(`ld_${sense}_hyper`).length > 0) sensoryDesc.push(`hypersensitivity in ${sense} sense (${getLDCheckedValues(`ld_${sense}_hyper`).join(', ')})`);
                    if (getLDCheckedValues(`ld_${sense}_hypo`).length > 0) sensoryDesc.push(`hyposensitivity in ${sense} sense (${getLDCheckedValues(`ld_${sense}_hypo`).join(', ')})`);
                    if (getLDCheckedValues(`ld_${sense}_seeking`).length > 0) sensoryDesc.push(`sensory seeking in ${sense} sense (${getLDCheckedValues(`ld_${sense}_seeking`).join(', ')})`);
                });
                if (sensoryDesc.length > 0) {
                    report += `Patient showed ${sensoryDesc.join(' / ')}.`;
                } else {
                    report += "No specific sensory processing patterns noted from checklist. ";
                }
                const examples = getLDVal('ld_sensory_assessment_others');
                if (examples) report += ` With example of: ${examples}`;
                report += "\n";

                if(!isLDChecked('ld_exclude_sensory_profile')) {
                    const informant = getLDVal('ld_sensory_profile_informant') || '(informant not specified)';
                    report += `Sensory profile done on: ${assessmentDate || '(date not specified)'}, with ${informant} as informant. Results showed that patient showed:\n`;
                    const spCats = [
                        { key: 'low_reg', name: 'low registration' },
                        { key: 'sensation_seeking', name: 'sensation seeking' },
                        { key: 'sensory_sensitive', name: 'sensory sensitive' },
                        { key: 'sensory_avoidance', name: 'sensory avoidance' }
                    ];
                    let spReportContent = "";
                    spCats.forEach(cat => {
                        const score = getLDVal(`ld_sp_${cat.key}_score`);
                        const interpretation = getLDCheckedValues(`ld_sp_${cat.key}_interpretation`).join(', ');
                        const scoreDisplay = (score !== null && score.trim() !== '') ? score : 'N/A';
                        if (scoreDisplay !== 'N/A' || interpretation) { 
                            spReportContent += `  - ${cat.name}: Score ${scoreDisplay}/75. Interpretation: ${interpretation || 'N/A'}\n`;
                        }
                    });
                     if (spReportContent) {
                        report += spReportContent;
                    } else {
                        report += "  Sensory Profile data not entered or not applicable.\n";
                    }
                }
                report += "\n";
            }
            
            if (!isLDChecked('ld_exclude_ba')) {
                report += "Behavioural Assessment\n";
                report += "-----------------------\n";
                if (!isLDChecked('ld_exclude_mas')) {
                    report += formatLine("MAS Target Behaviour", getLDVal('ld_mas_target_behaviour_overall'));
                    let masReportText = "Motivational Assessment Scale results:\n";
                    const masFunctions = ['sensory', 'escape', 'attention', 'tangible'];
                    let masDataFound = false;
                    masFunctions.forEach(func => {
                        const total = getLDVal(`ld_mas_${func}_total`);
                        const average = getLDVal(`ld_mas_${func}_average`);
                        const ranking = getLDVal(`ld_mas_${func}_ranking`);
                        if ((total !== null && total.trim() !== '') || (average !== null && average.trim() !== '' && average !== 'N/A') || (ranking !== null && ranking.trim() !== '')) {
                            masDataFound = true;
                            masReportText += `  - ${func.charAt(0).toUpperCase() + func.slice(1)}:\n    Total Score: ${(total || 'N/A')}\n    Average Score: ${(average || 'N/A')}\n    Relative Ranking: ${(ranking || 'N/A')}\n`;
                        }
                    });
                    report += masDataFound ? masReportText : "  Motivational Assessment Scale data not entered.\n";
                }
                if (!isLDChecked('ld_exclude_cbi')) {
                    report += formatLine("CBI Target Behaviour", getLDVal('ld_cbi_target_behaviour'));
                    report += formatLine("Challenging Behaviour Interview Score", `${getLDVal('ld_cbi_total_score') || 'N/A'}/55`);
                }
                 const cbiTarget = getLDVal('ld_cbi_target_behaviour');
                 const masTarget = getLDVal('ld_mas_target_behaviour_overall');
                 if ( (isLDChecked('ld_exclude_cbi') && isLDChecked('ld_exclude_mas')) && (cbiTarget || masTarget) ) {
                     report += formatLine("Patient's major challenging behaviour", cbiTarget || masTarget || "Not specified (MAS/CBI excluded)");
                } else if (!cbiTarget && !masTarget && !isLDChecked('ld_exclude_cbi') && !isLDChecked('ld_exclude_mas')){
                     report += "Patient's major challenging behaviour: Not specified\n";
                }
                report += "\n";
            }

            if (!isLDChecked('ld_exclude_ea')) {
                report += "Environmental Assessment\n";
                report += "-------------------------\n";
                let livesWith = getLDCheckedValues('ld_lives_with');
                if (getLDVal('ld_lives_with_others')) livesWith.push(getLDVal('ld_lives_with_others'));
                report += `Patient was living with ${livesWith.join('/') || 'N/A'}.\n`;

                if(!isLDChecked('ld_exclude_home_visit_env')) {
                    report += "\nHome Visit / Hostel Environment:\n";
                    let envLighting = formatCheckboxList(getLDCheckedValues('ld_env_lighting'));
                    let envNoise = formatCheckboxList(getLDCheckedValues('ld_env_noise'));
                    if (isLDChecked('ld_env_noise_not_available')) envNoise += (envNoise && envNoise !== 'N/A' ? ", " : "") + "Quiet zone/ Pad room was not available";
                    report += `  The hostel/ home was ${envLighting}. Noise level was ${envNoise}.\n`;
                    
                    let safetyHazards = getLDCheckedValues('ld_env_safety_hazard');
                    let safetyHazardDesc = getLDVal('ld_env_safety_hazard_others');
                    let safetyReportLine = "  Safety hazard: ";
                    if(isLDChecked('ld_env_safety_hazard_not_presented')) {
                        safetyReportLine += "Not presented. ";
                    } else if (safetyHazards.length > 0) {
                        safetyReportLine += `${safetyHazards.join(', ')}. `;
                        if(safetyHazardDesc) safetyReportLine += `(${safetyHazardDesc}). `;
                    } else if (safetyHazardDesc) {
                         safetyReportLine += `${safetyHazardDesc}. `;
                    } else {
                        safetyReportLine += "N/A. ";
                    }
                    report += safetyReportLine;

                    let socialStim = getLDCheckedValues('ld_env_social_stimulation').join('/');
                    let socialStimOthers = getLDVal('ld_env_social_stimulation_others');
                    if (socialStim) report += `There was ${socialStim}. `;
                    if (socialStimOthers) report += `(e.g. ${socialStimOthers}). `;
                    
                    let envChange = getLDCheckedValues('ld_env_change').join(', ');
                    let envChangeOthers = getLDVal('ld_env_change_others');
                    if (envChange || envChangeOthers) {
                        report += `There was recent change in environment/ carer/ routine: ${envChange}${envChangeOthers ? ` (${envChangeOthers})` : ''}.\n`;
                    } else {
                        report += "\n"; 
                    }
                    
                    report += "\n  Staff / Parent Interaction:\n";
                    report += formatLine("    Handling type", formatCheckboxList(getLDCheckedValues('ld_staff_handling_type')) + (getLDVal('ld_staff_handling_others') ? `, Others: ${getLDVal('ld_staff_handling_others')}`:''));
                    report += formatLine("    Staff's expectation on behaviour", getLDVal('ld_staff_expectation_behaviour'));
                    report += formatLine("    Hostel staff/ parents concerned about patient's behaviour of", getLDVal('ld_staff_parents_concern'));
                    report += formatMultiLine("    In response to patient's challenging behaviours, hostel staff/ parents would (staff measures) with satisfactory/ suboptimal effect", getLDVal('ld_staff_parents_response'));
                    
                    report += "\n  Restrain Policy:\n";
                    if (getLDRadioValue('ld_restrain_policy') === 'Yes') {
                        let restrainTypes = getLDCheckedValues('ld_restrainer_type').join(', ');
                        if(getLDVal('ld_restrainer_type_others')) restrainTypes += (restrainTypes ? ", " : "") + getLDVal('ld_restrainer_type_others');
                        report += `    Hostel staff/ parent would provide restrain (Type: ${restrainTypes || 'Not specified'}).\n`;
                        report += formatLine("      Restrain period", formatCheckboxList(getLDCheckedValues('ld_restrain_period')) + (getLDVal('ld_restrain_period_others') ? `, Others: ${getLDVal('ld_restrain_period_others')}` : ''));
                        report += formatMultiLine("      Situation of restrain", getLDVal('ld_restrain_situation'));
                        report += formatLine("      Body part on restrain", formatCheckboxList(getLDCheckedValues('ld_restrain_body_part')) + (getLDVal('ld_restrain_body_part_others') ? `, Others: ${getLDVal('ld_restrain_body_part_others')}` : ''));
                        report += formatMultiLine("      Other restrain information", getLDVal('ld_restrain_other_info'));
                    } else {
                        report += "    Hostel staff/ parent would not provide restrain.\n";
                    }

                    report += "\n  Family Involvement:\n";
                    report += formatLine("    Parents visit frequency", getLDVal('ld_parent_visit_frequency'));
                    report += formatLine("    Patient behaviour before/after visit", getLDVal('ld_patient_behaviour_visit'));
                    report += formatLine("    Parenting style", formatCheckboxList(getLDCheckedValues('ld_parenting_style')));
                    report += formatMultiLine("    Other info on parenting style", getLDVal('ld_parenting_style_other_info'));

                } else {
                     report += "Home Visit/Hostel Environment and related sub-sections excluded from report.\n";
                }
                report += formatMultiLine("\nOthers (e.g. Layout - Overall Environmental Assessment)", getLDVal('ld_env_others_layout'));
                report += "\n";
            }
            report += formatMultiLine("Occupation", getLDVal('ld_occupation_details'));
            report += "\n";

            if (!isLDChecked('ld_exclude_ifa')) {
                report += "Independent Function Assessment\n";
                report += "--------------------------------\n";
                if (!isLDChecked('ld_exclude_badl_mbi')) {
                    let badlReportStr = "BADL Qualitative Levels:\n";
                    const badlActivities = ['feeding', 'grooming', 'dressing', 'toileting', 'bathing'];
                    let badlLevelsSpecified = false;
                    badlActivities.forEach(activity => {
                        const level = getLDVal(`ld_badl_${activity}_level`);
                        if (level) {
                            badlLevelsSpecified = true;
                            badlReportStr += `  - ${activity.charAt(0).toUpperCase() + activity.slice(1)}: ${level}\n`;
                        }
                    });
                    report += badlLevelsSpecified ? badlReportStr : "  BADL: Qualitative levels not specified.\n";
                    report += formatLine("MBI Score", `${getLDVal('ld_mbi_total_score_display') || 'N/A'}/100`);
                    report += formatMultiLine("MBI Remarks", getLDVal('ld_mbi_remarks'));
                }
                if (!isLDChecked('ld_exclude_iadl_sibr')) {
                    let sibrChronAge = `Year: ${getLDVal('ld_sibr_chron_age_year') || 'N/A'}, Month: ${getLDVal('ld_sibr_chron_age_month') || 'N/A'}`;
                    let sibrIndepAge = `Year: ${getLDVal('ld_sibr_indep_age_year') || 'N/A'}, Month: ${getLDVal('ld_sibr_indep_age_month') || 'N/A'}`;
                    let sibrMaladaptive = getLDRadioValue('ld_sibr_maladaptive_level') || 'N/A';
                    let sibrSupportScore = getLDVal('ld_sibr_support_score') || 'N/A';
                    let sibrSupportLevel = getLDRadioValue('ld_sibr_support_level') || 'N/A';
                    report += `IADL (SIB-R Short form):\n`;
                    report += `  Patient's Chronological Age: ${sibrChronAge}\n`;
                    report += `  Broad Independence Age Equivalent: ${sibrIndepAge}\n`;
                    report += `  Maladaptive Behaviour Severity Level: ${sibrMaladaptive}\n`;
                    report += `  Support Score: ${sibrSupportScore}/100\n`;
                    report += `  Support Level: ${sibrSupportLevel}\n`;
                    report += formatMultiLine("  SIB-R Remarks", getLDVal('ld_sibr_remarks'));
                }
                report += "\n";
            }
            
            if (!isLDChecked('ld_exclude_wa')) {
                report += "Work Assessment\n";
                report += "----------------\n";
                if (!isLDChecked('ld_exclude_premorbid_work')) {
                    let premorbidParts = [];
                    getLDCheckedValues('ld_premorbid_status').forEach(val => {
                        if (val === "OE" && isLDChecked('ld_premorbid_oe_job_status_cb')) { 
                            const oeDetails = getLDVal('ld_premorbid_oe_job_details');
                            premorbidParts.push(oeDetails ? `OE (${oeDetails})` : 'OE');
                        } else if (val !== "OE") { 
                            premorbidParts.push(val);
                        }
                    });
                    let premorbidStr = premorbidParts.join(' / ');
                    const mainWorkTask = getLDVal('ld_premorbid_main_work_task');
                    if (mainWorkTask) {
                        premorbidStr += (premorbidStr ? ", " : "") + `Main work task: ${mainWorkTask}`;
                    }
                    report += formatLine("Premorbid Status", premorbidStr || "N/A");
                }
                if (!isLDChecked('ld_exclude_bwap2')) {
                    report += "BWAP-2:\n";
                    const bwapDomainKeys = ['wha', 'ir', 'cs', 'wps', 'bwa']; 
                    const bwapDomainNames = {
                        'wha': 'Work Habits/ Attitudes', 'ir': 'Interpersonal Relations',
                        'cs': 'Cognitive Skills', 'wps': 'Work Performance Skills',
                        'bwa': 'Broad Work Adjustment'
                    };
                    let bwaContentGenerated = false;
                    bwapDomainKeys.forEach(key => {
                        const percentile = getLDVal(`ld_bwap_${key}_percentile`);
                        const placements = getLDCheckedValues(`ld_bwap_${key}_placement`);
                        if ((percentile && percentile.trim() !== '') || placements.length > 0) {
                            bwaContentGenerated = true;
                            report += `  ${bwapDomainNames[key]} percentile: ${percentile || 'N/A'}. `;
                            report += placements.length > 0 ? `Working Placement: ${placements.join(', ')}.\n` : "\n";
                        }
                    });
                    report += !bwaContentGenerated ? "  BWAP-2 data not entered.\n" : "";
                    report += formatMultiLine("  BWAP-2 Remarks", getLDVal('ld_bwap_remarks'));
                }
                report += "\n";
            }

            if (!isLDChecked('ld_exclude_otp')) {
                report += "OT Plan:\n";
                report += "--------\n";
                let otPlanItems = [];
                const ldOtpItems = ldForm.querySelectorAll('input[name="ld_otp_item"]:checked');
                if (ldOtpItems) {
                    ldOtpItems.forEach(cb => {
                        let itemText = cb.value;
                        if (cb.id === "ld_otp_home_visit") { 
                            itemText = `Home / Hostel visit ${assessmentDate ? 'on ' + assessmentDate : '(date TBD)'}`;
                        }
                        otPlanItems.push(`- ${itemText}`);
                    });
                }
                const customOtPlan = getLDVal('ld_ot_plan_custom');
                if (customOtPlan) {
                    customOtPlan.split('\n').forEach(item => {
                        if (item.trim()) otPlanItems.push(`- ${item.trim()}`);
                    });
                }
                report += otPlanItems.length > 0 ? otPlanItems.join('\n') + '\n' : "(No OT Plan items selected or entered)\n";
                report += "\n";
            }

            if (ldReportTextArea) ldReportTextArea.value = report.trim();
        }

        window.copyLDReport = function() {
            if (!ldReportTextArea || !ldCopyMessage) return;
            ldReportTextArea.select();
            ldReportTextArea.setSelectionRange(0, 99999); 
            try {
                document.execCommand('copy');
                ldCopyMessage.textContent = 'LD Report Copied!';
                ldCopyMessage.style.display = 'inline';
                setTimeout(() => { ldCopyMessage.style.display = 'none'; }, 2000);
            } catch (err) {
                console.error('Failed to copy LD report: ', err);
                alert('Failed to copy LD report. Please copy manually.');
            }
            window.getSelection().removeAllRanges(); 
        }

        // --- Initial Page Load ---
        currentActiveFormId = 'adultDcSummaryContainer'; 
        setActiveForm('adultDcSummaryContainer', dcAdultBtn);

    }); 
    </script>
</body>
</html>
